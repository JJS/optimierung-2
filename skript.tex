\documentclass[10pt,a4paper]{article}
\usepackage[latin1]{inputenc}
\usepackage[ngerman]{babel}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{fancyhdr}
\usepackage{xcolor}
\usepackage{tikz}
\usepackage{enumerate}
\usepackage{makeidx}
\usepackage{listings}
\usepackage{mathpazo}
\usepackage[colorlinks=true,linkcolor=blue]{hyperref}

\makeindex
\newcommand{\size}{\text{size}}
\newcommand{\ggT}{\text{ggT}}
\newcommand{\rang}{\text{rang}}
\newcommand{\sgn}{\text{sgn}}

\usetikzlibrary{arrows,shapes,calc,backgrounds,fit}
\tikzset{
  vertex/.style={circle,draw=black!25,thick,top color=white,bottom color=black!15,minimum size=7.5mm,inner sep=0cm},
  vertexpt/.style={circle,draw=black!50,thick,fill=black!25,minimum size=1mm,inner sep=0cm},
  edge/.style={draw,-},
  arrow/.style={edge,->},
  annotation/.style={font=\footnotesize,node distance=18pt}}

\author{JJS}

\definecolor{secback}{rgb}{0.75,0.75,0.75}
\definecolor{headerback}{rgb}{0.8,0.8,0.8}

\newcommand\slbl{\label{\thesection}}
\newcommand\sslbl{\label{\thesubsection}}
\newcommand\ssslbl{\label{\thesubsubsection}}

%\renewcommand{\section}[1]{\refstepcounter{section}\setcounter{header}{0}\addcontentsline{toc}{section}{\thesection. #1}$\!$\vspace{0.3cm}\newline\vspace{0.01cm}\noindent\colorbox{secback}{\parbox{177.9mm}{\begin{LARGE}\textsc{\thesection. #1}\label{sec:\thepart\thesection}\end{LARGE}}}\vspace{0.3cm}\\}
%
%\newcommand{\header}[2]{\refstepcounter{header}$\!$\vspace{0.3cm}\newline\vspace{0.01cm}\noindent\colorbox{headerback}{\parbox{177.9mm}{\textbf{\theheader) #1} #2}}\vspace{0.3cm}\\}
%
%\newcommand{\headera}[2]{$\!$\vspace{0.3cm}\\\noindent\textbf{#1} #2\vspace{0.05cm}\hrule\vspace{0.3cm}\noindent}
%
%\usepackage[nohead,nofoot,lmargin=1.5cm,rmargin=1.5cm,tmargin=1.5cm,bmargin=1.5cm,headsep=0.5cm,headheight=12.4pt, foot=0.75cm]{geometry}
%\renewcommand{\footrulewidth}{0.4pt}
%\newcounter{header}

\usepackage[bf]{caption}
\renewcommand{\figurename}{Abb.}

\usepackage[nohead,nofoot,lmargin=1.5cm,rmargin=1.5cm,tmargin=1.5cm,bmargin=1.5cm,headsep=0.5cm,headheight=12.4pt, foot=0.75cm]{geometry}
\renewcommand{\footrulewidth}{0.4pt}

%git
\pagestyle{fancy}
\fancyhf{}
\rhead{Seite \thepage}
\lhead{Optimierung 2 Mitschrift}
\lfoot{WS 08/09}
\cfoot{Jan Sommer}
\rfoot{sommerj@in.tum.de}
\setcounter{section}{-1}
\newcounter{def}
\setcounter{section}{4}
\begin{document}
%\maketitle
%\pagebreak
\hfill\textbf{14.10.2008}
\section*{Wiederholung}
\subsection*{Lineare Programme}
\[\max c^Tx\qquad,\qquad Ax\leq b\]
\subsection*{Polyeder}
Polyeder ist zulässiger Bereich eines LP
\begin{itemize}
\item $\mathcal H$-Darstellung (\textit{half-spaces}): $P=\left\{x\in\mathbb R^n\::\:Ax\leq b\right\}$
\item $\mathcal V$-Darstellung (\textit{vertex}): $P=conv(V)+pos(S)$ ($V$, $S$ endlich)
\end{itemize}
\subsection*{Kegel}
\begin{itemize}
\item $N_P(x^*)=\left\{c\in\mathbb R^n\::\:\max_{x\in P}c^Tx=c^Tx^*\right\}$
\item $S_P(x^*)=\bigcap_{c\in N_P(x^*)}H^{\leq}_{(c,0)}$
\item $S_P(B)=\left\{x\in\mathbb R^n\::\:A_Bx\leq0\right\}$
\end{itemize}
\subsection*{Simplexalgorithmus}
\begin{itemize}
\item Starte bei beliebiger Ecke
\item Bestimme Kanten von $S_P(B)$
\item Bestimme Verbesserungskante ($-A_B^{-1}$)
\item Laufe Verbesserungskante entlang zur nächsten Ecke
\item[$\Rightarrow$] endliche, exponentielle worst case Laufzeit
\end{itemize}
\subsection*{Dualität}
Primales Problem (P):
\[\max c^Tx\qquad,\qquad Ax\leq b\]
Duales Problem (D):
\[\min b^Ty\qquad,\qquad A^Ty=c\:,\:y\geq0\]
Primale Nebenbedingung $\leftrightarrow$ duale Variablen
\subsection*{Komplementarität}
$x^*$ ist optimal für (P) genau dann, wenn $x^*$ zulässig ist und wenn es ein dual zulässiges $y^*$ gibt mit
\begin{itemize}
\item für alle $i$ mit $a_i^Tx^*<\beta_i$ $\Rightarrow$ $\eta^*_i=0$ oder
\item $c^Tx^*=b^Ty^*$ (starker Dualitätssatz)
\end{itemize}
Für zulässige $x$ und $y$ gilt (schwacher Dualitätssatz):
\[c^Tx^*\leq b^Ty^*\]
\hfill\textbf{17.10.2008}
\section{Diskrete Strukturen}\slbl
\subsection{Graphen}\sslbl
\subsubsection{Beispiel: Straßenkreuzung}\ssslbl
\begin{itemize}
\item Kürzester Weg
\item Straßenreinigung
\item TSP\\[1ex]
$\vdots$
\end{itemize}
\subsubsection{Bezeichung}\ssslbl
Sei $X$ eine Menge. Dann bezeichnet $2^X$ die \textit{Potenzmenge}\index{Potenzmenge} von $X$. Für $k\in\mathbb N$ sei
\[\binom Xk:=\left\{S\in2^X\::\:\vert S\vert=k\right\}\]
Menge der $k$-elementigen Teilmengen von $X$.
\subsubsection{Definition}\ssslbl
Seien $V$, $E$ endliche Mengen mit $V\cap E=\emptyset$ und $\nu:E\rightarrow\binom V1\cup\binom V2\cup V^2$. Dann heißt $G:=(V,E,\nu)$ \textit{allgemeiner Graph}\index{Graph!allgemeiner}. Elemente von $V$: \textit{Knoten}\index{Knoten}, Elemente von $E$: \textit{Kanten}\index{Kante}.\\[1ex]
Sei $e\in E$. Existiert ein $v\in V$ mit $\nu(e)\in\left\{\{v\},(v,v)\right\}$, so heißt $e$ \textit{Schlinge}\index{Schlinge}. Ist $\nu(e)\in\binom V1\cup\binom V2$, so heißt $e$ \textit{ungerichtet}\index{Kante!ungerichtete}. Ist $\nu(e)\in V^2$, so heißt $e$ \textit{gerichtet}\index{Kante!gerichtete}. Gilt $\nu(e)=(v,w)$, so heißt $v$ \textit{Anfangs-} und $w$ \textit{Endknoten} von $e$.\\[1ex]
Der allgemeine Graph $G$ heißt \textit{schlingenfrei}\index{Graph!schlingenfrei}, wenn $E$ keine Schlinge enthält. Sind alle Kanten ungerichtet bzw. gerichtet, dann heißt $G$ \textit{ungerichtet}\index{Graph!ungerichteter} bzw. \textit{gerichtet}\index{Graph!gerichteter}.\\[1ex]
Allgemeine schlingenfreie ungerichtete Graphen heißen \textit{Multigraphen}\index{Graph!Multi-}\index{Multigraph}. Analog \textit{gerichtete Multigraphen}.\\[1ex]
Ist $\nu$ injektiv und gibt es keine $e_1,e_2\in E$ und $v\in V$ mit  $\nu(e_1)=\{v\}$, $\nu(e_2)=(v,v)$, so heißt $G$ \textit{schlicht}\index{Graph!schlichter} (\textit{einfach}\index{Graph!einfacher}).\\[1ex]
Sind $G(V,E,\nu)$ allgemeiner Graph, $\Phi:E\rightarrow\mathbb R$, so heißt $(G;\Phi)$ \textit{gewichteter}\index{Graph!gewichteter} allgemeiner Graph. Für $e\in E$ heißt $\Phi(e)$ \textit{Gewicht}\index{Gewicht}\index{Kosten}\index{Länge}\index{Kapazität} (Kosten, Länge, Kapazität $\dots$) von $e$.
\subsubsection{Beispiel}\ssslbl
$V=\{v_1,v_2,v_3,v_4\}$, $E=\{e_1,\dots,e_8\}$ mit $V\cap E=\emptyset$, $v:E\rightarrow\binom V1\cup\binom V2\cup V^2$ definiert durch
\begin{align*}
\nu(e_1)&:=\{v_1\}\\
\nu(e_2)&:=(v_1,v_2)\\
\nu(e_3)&:=(v_2,v_1)\\
\nu(e_4)&:=\{v_1,v_4\}\\
\nu(e_5)&:=(v_1,v_3)\\
\nu(e_6)&:=\{v_3,v_4\}\\
\nu(e_7)&:=\{v_3,v_4\}\\
\nu(e_8)&:=(v_3,v_4)\\
\end{align*}
\subsubsection*{Graphische Darstellung}
\begin{center}
\begin{tikzpicture}[>=stealth']
\tikzstyle{every loop}=[]
\foreach \pos/\name in {{(2,2)/v_1},{(4,0)/v_2},{(0,0)/v_3},{(0,3)/v_4}}
  \node[vertex] (\name) at \pos {$\name$};
\path[edge,loop above] (v_1) to (v_1) node [midway] {$e_1$};
\path[arrow,bend left] (v_1) to (v_2) node [midway,right] {$e_2$};
\path[arrow,bend left] (v_2) to (v_1) node [midway,left] {$e_3$};
\path[edge] (v_1) to (v_4) node[midway,above] {$e_4$};
\path[arrow] (v_1) to (v_3) node[midway, right] {$e_5$};
\path[edge,bend left] (v_3) to (v_4) node[midway,left] {$e_6$};
\path[edge,bend left] (v_4) to (v_3) node[midway,right] {$e_7$};
\path[arrow] (v_3) to (v_4) node[midway,fill=white] {$e_8$};
\end{tikzpicture}
\end{center}
\subsubsection{Bezeichnung}\ssslbl
Seien $X$ eine nichtleere endliche Menge, $k:=\vert X\vert$. Jede Bijektion $\tau:\{1,\dots,k\}\rightarrow X$ heißt \textit{Ordnung}\index{Ordnung} (\textit{Reihenfolge}\index{Reihenfolge}) auf $X$. Ist $\tau$ Reihenfolge auf $X$, so setzt man oft $x_i:=\tau(i)$ und schreibt $x=\{x_0,\dots,x_k\}$. Umgekehrt $\tau(i)=x_i$ legt Reiehenfolge fest.
\subsubsection{Definition}\ssslbl
Seien $G=(V,E,\nu)$ allgemeiner Graph, $n=\vert V\vert$, $m=\vert E\vert$, $m,n\geq1$
\begin{enumerate}[a)]
\item Seien $\tau_V,\tau_E$ Reihenfolgen auf $V$ bzw. $E$, dh. $V=\{v_1,\dots,v_n\}$, $E=\{e_1,\dots,e_m\}$. Ferner sei die $n\times m$-Matrix $S_G:=S_G(\tau_V,\tau_E):=\left(\sigma_{ij}\right)_{\underset{j=1,\dots,m}{i=1,\dots, n}}$ definiert durch
\[\sigma_{ij}:=\begin{cases}1&\text{falls }e_j\text{ ungerichtet und }v_i\in\nu(e_j)\\
-1&\text{falls }e_j\text{ gerichtet und }v_i\text{ Anfangsknoten von }e_j\\
+1&\text{falls }e_j\text{ gerichtet und }v_i\text{ Endknoten von }e_j\\
0&\text{sonst}\end{cases}\]
$S_G$ heißt (\textit{Knoten-Kanten}) \textit{Inzidenzmatrix}\index{Inzidenzmatrix} von $G$. Der $j$-te Spaltenvektor von $S_G$ heißt \textit{Inzidenzvektor}\index{Inzidenzvektor} von $e_j$.
\item Seien $G_i=(V_i,E_i,\nu_i)$ $i=1,2$ allgemeine Graphen\hfill\textbf{21.10.2008}
\[n:=\vert V_1\vert=\vert V_2\vert\:,\quad\vert E_1\vert=\vert E_2\vert\:,\quad n,m\geq1\]
Dann heißen $G_1$, $G_2$ \textit{isomorph}\index{Graph!isomorpher}\index{Isomorphie}, falls Reihenfolgen $\tau_{V_i}$ auf $V_i$ und $\tau_{E_i}$ auf $E_i$ existieren, ($i=1,2$), so dass
\[S_{G_1}\left(\tau_{V_1},\tau_{E_1}\right)=S_{G_2}\left(\tau_{V_2},\tau_{E_2}\right)\]
\end{enumerate}
\subsubsection{Beispiel}\ssslbl
Gegeben ist allgemeiner Graph aus \textit{(\ref{5.1.4})}:
\begin{center}
\begin{tikzpicture}[>=stealth']
\tikzstyle{every loop}=[]
\foreach \pos/\name in {{(2,2)/v_1},{(4,0)/v_2},{(0,0)/v_3},{(0,3)/v_4}}
  \node[vertex] (\name) at \pos {$\name$};
\path[edge,loop above] (v_1) to (v_1) node [midway] {$e_1$};
\path[arrow,bend left] (v_1) to (v_2) node [midway,right] {$e_2$};
\path[arrow,bend left] (v_2) to (v_1) node [midway,left] {$e_3$};
\path[edge] (v_1) to (v_4) node[midway,above] {$e_4$};
\path[arrow] (v_1) to (v_3) node[midway, right] {$e_5$};
\path[edge,bend left] (v_3) to (v_4) node[midway,left] {$e_6$};
\path[edge,bend left] (v_4) to (v_3) node[midway,right] {$e_7$};
\path[arrow] (v_3) to (v_4) node[midway,fill=white] {$e_8$};
\end{tikzpicture}
\end{center}
\[S_G=\left(\begin{array}{cccccccc}1&-1&1&1&-1&0&0&0\\0&1&-1&0&0&0&0&0\\0&0&0&0&1&1&1&-1\\0&0&0&1&0&1&1&1\end{array}\right)\]
\subsubsection{Definition}\ssslbl
$G=(V,E,\nu)$ allgemeiner Graph. Abbildungen $deg_G(v)$, $deg_{\text{in}\:G}(v)$, $deg_{\text{aus}\:G}(v)$: $V\rightarrow\mathbb N_0$ seien für $v\in V$ definiert durch
\begin{align*}
deg_G(v)&:=2\left\vert\left\{e\in E\::\:\nu(e)=\{v\}\right\}\right\vert+\left\vert\left\{e\in E\::\:\exists w\in V\setminus\{v\}\::\:\nu(e)=\{v,w\}\right\}\right\vert\\
deg_{\text{in}\:G(v)}&:=\left\vert\left\{e\in E\::\:\nu(e)=\{v\}\vee\exists\left(w\in V\setminus\{v\}\right)\::\:\nu(e)=(w,v)\right\}\right\vert\\
deg_{\text{aus}\:G(v)}&:=\left\vert\left\{e\in E\::\:\nu(e)=\{v\}\vee\exists\left(w\in V\setminus\{v\}\right)\::\:\nu(e)=(v,w)\right\}\right\vert\\
\end{align*}
heißen \textit{Grad}\index{Grad}, \textit{Ingrad}\index{Grad!In-}\index{Ingrad}, \textit{Ausgrad}\index{Ausgrad}\index{Grad!Aus-} (\textit{Valenz}\index{Valenz|see{Grad}}). Knoten mit In-aus-Grad =0 heißen \textit{isoliert}\index{Knoten!isolierter}.
\subsubsection{Definition}\ssslbl
$G=(V,E,\nu)$ allgemeiner Graph, $p\in\mathbb N$. Ein \textit{Kantenzug}\index{Kantenzug} der \textit{kombinatorischen Länge}\index{Länge!kombinatorische} $p$ in $G$ ist Sequenz
\[\left(v_0,e_1,v_1,e_2,\dots,e_p,v_p\right)\]
von (alternierend) Knoten $v_0,\dots,v_p$, Kanten $e_1,\dots,e_p$, so dass für $k=1,\dots,p$ gilt
\[\nu(e_k)\in\begin{cases}\left\{\{v\},(v,v)\right\}&\text{falls }v_{k-1}=v_k=v\\\left\{\{v_{k-1},v_k\},(v_{k-11},v_k)\right\}&\text{falls }v_{k-1}\neq v_k\end{cases}\]
(Oft kürzer $(e_1,\dots,e_p)$, manchmal -wenn eindeutig- $(v_0,\dots,v_p)$)\\[1ex]
Seien $v,w\in V$. $w$ heißt \textit{von $v$ aus erreichbar}, wenn $v=w$, oder wenn es einen Kantenzug $\left(v_0,e_1,\dots,e_p,v_p\right)$ in $G$ gibt mit $v_0=v$ und $v_p=w$.\\[1ex]
Sei $W:=\left(v_0,e_1,\dots,e_p,v_p\right)$ Kantenzug. $W$ heißt \textit{einfach}\index{Kantenzug!einfacher}, wenn $e_1,\dots,e_p$ paarweise verschieden sind und $(v_0-v_p)$-\textit{Weg}\index{Weg}, wenn Knoten $v_0,\dots,v_p$ paarweise verschieden sind.\\[1ex]
$W$ \textit{geschlossen}\index{Kantenzug!geschlossener} wenn $v_0=v_p$ ist, \textit{Kreis}\index{Kreis} wenn $(v_0,e_1,\dots,e_{p-1},v_{p-1})$ Weg ist.\\[1ex]
Oftmals einzelner Knoten: (uneigentlicher) Weg, Kreis\\[1ex]
Jeder Kreis, der alle Knoten von $G$ enthält, heißt \textit{Hamilton-Kreis}\index{Kreis!Hamilton-}\index{Hamilton-Kreis} ($G$ heißt dann \textit{hamiltonsch}\index{Graph!hamiltonscher})
\subsubsection{Bemerkung}\ssslbl
Seien $G(V,E,\nu)$ allgemeiner Graph, $s,t\in V$
\begin{enumerate}[(a)]
\item Ist $t$ von $s$ aus erreichbar, so gibt es $s-t$-Weg
\item Jeder (eigentliche) geschlossener Kantenzug enthält einen (eigentlichen) Kreis
\end{enumerate}
\subsubsection*{Beweis}
\begin{enumerate}[(a)]
\item Jeder Kantenzug $(v_0,e_1,\dots,v_p)$ mit $s=v_0$, $t=v_p$ minimaler Länge ist ein $s-t$-Weg
\item analog
\end{enumerate}
\subsubsection{Bemerkung}\ssslbl
$G(V,E,\nu)$ allgemeiner Graph, $\sim$ Relation auf $V\times V$ definiert durch $v\sim w\::\Leftrightarrow\:w$ ist von $v$ aus erreichbar. Dann gilt
\begin{enumerate}[(a)]
\item $\sim$ ist reflexiv, transitiv
\item Ist $G$ ungerichtet, so ist $\sim$ symmetrisch
\end{enumerate}
\subsubsection{Definition}\ssslbl
$G=(V,E,\nu)$ allgemeiner Graph, $\Phi:E\rightarrow\mathbb R$. Sei $W=(v_0,e_1,\dots,e_p,v_p)$ Kantenzug.
\[\varphi(W):=\sum_{i=1}^p\Phi(e_i)\]
\textit{Länge von $W$}\index{Kantenzug!Länge} (bez. $\Phi$) (Ist $\Theta:V\rightarrow\mathbb R$ so erhält man \textit{Knotengewichtung}\index{Knotengewichtung}).
\subsubsection{Definition}\ssslbl
$G_i=(V_i,E_i,\nu_i)$, $i=1,2$ allgemeine Graphen. Gilt $V_1\subset V_2$, $E_1\subset E_2$, $\nu_1=\nu_2\vert_{E_1}$, so heißt $G_1$ \textit{Teil}-\index{Teilgraph}\index{Graph!Teil-}, \textit{Sub}-\index{Subgraph|see{Teilgraph}}, \textit{Untergraph}\index{Untergraph|see{Teilgraph}} von $G_2$ (Schreibweise $G_1\subset G_2$).\\[1ex]
Ist $G_1$ Teilgraph von $G_2$ und gilt
\[E_1=\left\{e\in E_2\::\:\nu_2(e)\in\binom{V_1}1\cup\binom{V_1}2\cup V_1^2\right\}\]
so heißt $G_1$ der durch $V_1$ in $G_2$ \textit{induzierte Teilgraph}\index{Teilgraph!induzierter}.
\subsubsection{Beispiel}\ssslbl
$G$ aus \textit{(\ref{5.1.4})}:
\begin{figure}
\begin{center}
\begin{tikzpicture}[>=stealth']
\tikzstyle{edge}=[draw,-]
\tikzstyle{arrow}=[edge,->]
\tikzstyle{every loop}=[]
\foreach \pos/\name in {{(2,2)/v_1},{(4,0)/v_2},{(0,0)/v_3},{(0,3)/v_4}}
  \node[vertex] (\name) at \pos {$\name$};
\path[edge,loop above] (v_1) to (v_1) node [midway] {$e_1$};
\path[arrow,bend left] (v_1) to (v_2) node [midway,right] {$e_2$};
\path[arrow,bend left] (v_2) to (v_1) node [midway,left] {$e_3$};
\path[edge] (v_1) to (v_4) node[midway,above] {$e_4$};
\path[arrow] (v_1) to (v_3) node[midway, right] {$e_5$};
\path[edge,bend left] (v_3) to (v_4) node[midway,left] {$e_6$};
\path[edge,bend left] (v_4) to (v_3) node[midway,right] {$e_7$};
\path[arrow] (v_3) to (v_4) node[midway,fill=white] {$e_8$};
\end{tikzpicture}
\begin{tikzpicture}[>=stealth']
\tikzstyle{every loop}=[]
\foreach \pos/\name in {{(2,2)/v_1},{(4,0)/v_2},{(0,3)/v_4}}
  \node[vertex] (\name) at \pos {$\name$};
\path[edge] (v_1) to (v_4) node[midway,above] {$e_4$};
\end{tikzpicture}
\begin{tikzpicture}[>=stealth']
\tikzstyle{every loop}=[]
\foreach \pos/\name in {{(2,2)/v_1},{(4,0)/v_2},{(0,3)/v_4}}
  \node[vertex] (\name) at \pos {$\name$};
\path[edge,loop above] (v_1) to (v_1) node [midway] {$e_1$};
\path[arrow,bend left] (v_1) to (v_2) node [midway,right] {$e_2$};
\path[arrow,bend left] (v_2) to (v_1) node [midway,left] {$e_3$};
\path[edge] (v_1) to (v_4) node[midway,above] {$e_4$};
\end{tikzpicture}
\end{center}
\caption{Zu \textit{(\ref{5.1.14})}: Graphen $G$, $S_1$ und $S_2$}
\end{figure}
$U:=\{v_1,v_2,v_4\}$, $E_1:=\{e_4\}$, $E_2:=\{e_1,e_2,e_3,e_4\}$ und $S_1:=\left(U,E_1,\nu\vert_{E_1}\right)$, $S_2:=\left(U,E_2,\nu\vert_{E_2}\right)$. Beides sind Teilgraphen, $S_2$ induziert.
\subsubsection{Bemerkung}\ssslbl
$G=(V,E,\nu)$ allgemeiner Graph, $W=\left(v_0,e_1,\dots,e_p,v_p\right)$ Kantenzug. $V_W=\left\{v\::\:\exists k\in\{0,\dots,p\}\::\:v=v_k\right\}$, $E_W=\left\{e\::\:\exists k\in\{1,\dots,p\}\::\:e=e_k\right\}$. Dann ist $\left(V_W,E_W,\nu\vert_{E_W}\right)$ Teilgraph von $G$.\\[1ex]
Oftmals werden daher Wege etc. als Teilgraph aufgefasst.
\subsubsection{Definition}\ssslbl
$G$ allgemeiner Graph, $s\in V$, $U(S)$ Menge der von $s$ erreichbaren Knoten. Gilt $U(s)=V$, so heißt $G$ von $s$ aus \textit{zusammenhängend}\index{Graph!zusammenhängender}. $G$ heißt (stark) \textit{zusammendhängend} wenn $G$ von jedem seiner Knoten aus zusammenhängend ist. Ein induzierter Teilgraph $S$ von $G$ heißt (starke) \textit{Zusammenhangskomponente}\index{Zusammenhangskomponente}, wenn $S$ (stark) zusammenhängend ist und kein (stark) zusammenhängender induzierter Teilgraph existiert, der $S$ echt enthält.\\[1ex]
Wichtige Grundlagen:\hfill\textbf{24.10.2008}
\subsubsection{Bezeichnung}\ssslbl
\begin{enumerate}[(a)]
\item $G=(V,E,\nu)$ schlingenfreier, schlichter allgemeiner Graph. $\hat E:=\nu(E)$, $\hat G:=(V,\hat E)$. Ist $G$ ungerichtet, so heißt $\hat G$ \textit{Graph}\index{Graph}, ist $G$ gerichtet, so heißt $\hat G$ \textit{Digraph}\index{Digraph}\index{Graph!Di-} bzw. gerichteter Graph\index{Graph!gerichteter}.
\item Sind $G(V,E)$ ein Graph bzw. Digraph, $\Phi:E\rightarrow\mathbb R$, so heißt $G(V,E,\Phi)$ \textit{gewichteter Graph}\index{Graph!gewichteter} bzw. \textit{Digraph}\index{Digraph!gewichteter}.
\item Seien $G=(V,E)$ Graph / Digraph, $U\subset V$. Der durch $U$ induzierte Teilgraph von $G$ wird mit $G_U$ bzw. $(V_U,E_U)$ bezeichnet.
\end{enumerate}
\subsubsection{Beispiel: Errichten eines Gebäudes}\ssslbl
Teilgewerke $A_1,\dots,A_9$. Abhängigkeit
\begin{center}
\begin{tabular}{c||c|c|c|c|c|c|c|c|c}
\textbf{Gewerk}&$A_1$&$A_2$&$A_3$&$A_4$&$A_5$&$A_6$&$A_7$&$A_8$&$A_9$\\
\hline
\textbf{Vorgänger (direkt)}&$-$&$A_1$&$A_1,A_2$&$A_1$&$A_3$&$A_3,A_4,A_7$&$A_3,A_5$&$A_6$&$A_7,A_8$
\end{tabular}
\end{center}
Gefragt: Mindestbauzeit abhängig von Einzelausführungszeiten $\gamma_i$ von $A_i$:
\begin{align*}
\gamma_1=\gamma_4&=4\\
\gamma_2=\gamma_5=\gamma_8&=3\\
\gamma_3=\gamma_6=\gamma_9&=2\\
\gamma_7&=1
\end{align*}
\subsubsection*{Digraph (Abhängigkeiten)}
\begin{center}
\begin{tikzpicture}[>=stealth']
\matrix[row sep=1cm,column sep=1cm]{
 & \node (v_4) [vertex] {$v_4$}; & \node (v_6) [vertex] {$v_6$}; &
     \node (v_8) [vertex] {$v_8$}; & \\
 \node (v_1) [vertex] {$v_1$}; & \node (v_3) [vertex] {$v_3$}; & &
     \node (v_7) [vertex] {$v_7$}; & \node (v_9) [vertex] {$v_9$}; \\
  & \node (v_2) [vertex] {$v_2$}; & \node (v_5) [vertex] {$v_5$}; & & \\
};
\node [annotation,above left of=v_1]  {4};
\node [annotation,below right of=v_2] {3};
\node [annotation,above left of=v_3]  {2};
\node [annotation,above left of=v_4]  {4};
\node [annotation,below right of=v_5] {3};
\node [annotation,above left of=v_6]  {2};
\node [annotation,below right of=v_7] {1};
\node [annotation,above left of=v_8]  {3};
\node [annotation,below right of=v_9] {2};

\foreach \from/\to in {
    {1/2}, {1/3}, {1/4},
    {2/3},
    {3/5}, {3/6}, {3/7},
    {4/6},
    {5/7},
    {6/8},
    {7/6}, {7/9},
    {8/9}}
  \path [arrow] (v_\from) to (v_\to);
\end{tikzpicture}
\end{center}

\subsubsection*{Modellierung mit Kantengewichte}
\begin{center}
\begin{tikzpicture}[>=stealth']
\def\doublevertex#1{\node (v_#1) [vertex] {$v_#1$};%
  \node (w_#1) [vertex,right of=v_#1] {$w_#1$};%
  \path [arrow] (v_#1) to (w_#1);}
\matrix[row sep=1cm,column sep=1cm]{
 & \doublevertex4 & \doublevertex6 & \doublevertex8 & \\
 \doublevertex1 & \doublevertex3 & & \doublevertex7 & \doublevertex9 \\
 & \doublevertex2 & \doublevertex5 & & \\
};

\foreach \n/\g/\pos in {
    {1/4/above}, {2/3/above}, {3/2/above},
    {4/4/above}, {5/3/above}, {6/2/above},
    {7/1/below}, {8/3/above}, {9/2/above}}
  \path [arrow] (v_\n) to node [midway,\pos,annotation] {\g} (w_\n);

\foreach \from/\to in {
    {1/2}, {1/3}, {1/4},
    {2/3},
    {3/5}, {3/6}, {3/7},
    {4/6},
    {5/7},
    {6/8},
    {7/6}, {7/9},
    {8/9}}
  \path [arrow] (w_\from) to (v_\to);
  
\begin{pgfonlayer}{background}
  \foreach \n in {1,...,9}
    \node [thick,draw=black!25,fit=(v_\n) (w_\n)] {};
\end{pgfonlayer}
\end{tikzpicture}
\end{center}

\begin{center}
\begin{tikzpicture}[>=stealth',node distance=5mm]
\def\doublevertex#1{\node (v_#1) [vertexpt] {};%
  \node (w_#1) [vertexpt,right of=v_#1] {};%
  \path [arrow] (v_#1) to (w_#1);}
\matrix[row sep=1.5cm,column sep=1.5cm]{
 & \doublevertex4 & \doublevertex6 & \doublevertex8 & \\
 \doublevertex1 & \doublevertex3 & & \doublevertex7 & \doublevertex9 \\
 & \doublevertex2 & \doublevertex5 & & \\
};

\foreach \from/\to in {
    {1/2}, {1/3}, {1/4},
    {2/3},
    {3/5}, {3/6}, {3/7},
    {4/6},
    {5/7},
    {6/8},
    {7/6}, {7/9},
    {8/9}}
  \path [arrow] (w_\from) to (v_\to);

\foreach \from/\to in {
    {1/2}, {2/3}, {3/5}, {5/7},
    {7/6}, {6/8}, {8/9}} {
  \path [arrow,red,thick] (v_\from) to (w_\from);
  \path [arrow,red,thick] (w_\from) to (v_\to);
}
\path [arrow,red,thick] (v_9) to (w_9);

\foreach \n/\z in {
  {1/4}, {3/9}, {4/8},
  {6/15}, {7/13}, {8/18}, {9/20}}
  \path (v_\n) to node [midway,yshift=12pt,annotation] {\textcolor{blue}{\z}} (w_\n);
  
\foreach \n/\z in {{2/7}, {5/12}}
  \path (v_\n) to node [midway,yshift=-12pt,annotation] {\textcolor{blue}{\z}} (w_\n);

\begin{pgfonlayer}{background}
  \foreach \n in {1,...,9}
    \node [thick,draw=black!25,fit=(v_\n) (w_\n)] {};
\end{pgfonlayer}
\end{tikzpicture}\par
  \small\emph{\textcolor{red}{kritischer~Pfad}},
  \emph{\textcolor{blue}{Mindestausführungszeit}}
\end{center}

\subsubsection{Definition}\ssslbl
Seien $G=(V,E)$ Graph / Digraph, $n:=\vert V\vert\geq1$, $\tau_V$ gegebene Ordnung auf $V$. Ferner
\[\alpha_{ij}:=\begin{cases}1&\text{falls }\{v_i,v_j\}\in E\text{ bzw. }(v_i,v_j)\in E\\0&\text{sonst}\end{cases}\]
und $A_G:=A_G(\tau_V):=(\alpha_{ij})_{i,j=1,\dots,n}$. Dann heißt $A_G$ \textit{Adjazenzmatrix}\index{Adjazenzmatrix} von $G$.
\subsubsection{Beispiel}\ssslbl
\begin{center}
\begin{tikzpicture}[>=stealth',node distance=1.5cm]
\node (v_1) [vertex]                    {$v_1$};
\node (v_2) [vertex,above right of=v_1] {$v_2$};
\node (v_3) [vertex,below right of=v_1] {$v_3$};
\node (v_4) [vertex,right of=v_2]       {$v_4$};
\node (v_5) [vertex,right of=v_3]       {$v_5$};
\node (v_6) [vertex,below right of=v_4] {$v_6$};

\foreach \from/\to in {
    {1/2}, {1/3}, {1/5},
    {2/3}, {2/4}, {2/5}, {2/6},
    {3/4},
    {5/6}}
  \path [edge] (v_\from) to (v_\to);
\end{tikzpicture}\hspace{1cm}
\begin{tikzpicture}[>=stealth']
\node (v_1) [vertex] at (0,2) {$v_1$};
\node (v_2) [vertex] at (0,0) {$v_2$};
\node (v_3) [vertex] at (2,2) {$v_3$};
\node (v_4) [vertex] at (2,0) {$v_4$};
\node (v_5) [vertex] at (4,1) {$v_5$};

\foreach \v/\w in {{1/2}, {1/3}, {2/4}, {3/5}} {
  \path [arrow,bend right] (v_\v) to (v_\w);
  \path [arrow,bend right] (v_\w) to (v_\v);
}
\foreach \from/\to in {{1/4}, {3/4}, {4/5}}
  \path [arrow] (v_\from) to (v_\to);
\end{tikzpicture}\\
\emph{Graphen $G_1$ und $G_2$}
\end{center}
\[A_{G_1}=\underbrace{\left(\begin{array}{cccccc}
0&1&1&0&1&0\\
1&0&1&1&1&1\\
1&1&0&1&0&0\\
0&1&1&0&0&0\\
1&1&0&0&0&1\\
0&1&0&0&1&0
\end{array}\right)}_{\text{symmetrisch}}\quad,\qquad
A_{G_2}=\underbrace{\left(\begin{array}{ccccc}
0&1&1&1&0\\
1&0&0&1&0\\
1&0&0&1&1\\
0&1&0&0&1\\
0&0&1&0&0
\end{array}\right)}_{\text{nicht symmetrisch}}\]
\subsubsection{Bemerkung}\ssslbl
$G=(V,E)$ Graph, $\tau_V$ Ordnung auf $V$. Dann ist $A_G$ symmetrisch.
\subsubsection{Bemerkung}\ssslbl
Durch Ersetzen jeder Kante $\{v,w\}$ durch $(v,w)$, $(w,v)$ kann man einen (ungerichteten) Graphen auch als gerichtet auffassen. Ist $G$ gewichtet, so überträgt sich das Gewicht von $\{v,w\}$ auf beide Kanten $(v,w)$, $(w,v)$.
\begin{center}
\begin{tikzpicture}
\node[vertexpt] (v0) at (0,0) {};
\node[vertexpt] (v1) at (2,0) {};

\path[edge] (v0) to (v1) node[midway,above] {$\alpha$};

\path[arrow] (3,0) to (4,0);

\node[vertexpt] (v2) at (5,0) {};
\node[vertexpt] (v3) at (7,0) {};

\path[arrow,bend left] (v2) to (v3) node[midway,above] {$\alpha$};
\path[arrow,bend left] (v3) to (v2) node[midway,below] {$\alpha$};
\end{tikzpicture}
\end{center}
Jetzt vorrangig (zunächst) ungerichtete Graphen.
\subsubsection*{Straßennetz}
\begin{center}
\begin{tikzpicture}
\foreach \pos/\name in {{(0,3)/1}, {(0.5,1.5)/2}, {(0.5,5)/3}, {(2.5,0)/4}, {(2.5,2)/5}, {(3,5.5)/6}, {(4,2.5)/8}, {(5,4)/9}}
  \node[vertexpt] (v\name) at \pos {};
\node[vertex] (v0) at (0.5,6.5) {$s$};
\node[vertex] (v7) at (4,0.5) {$t$};

\path[edge,blue,very thick] (v1) to (v2) {};
\path[edge,blue,very thick] (v2) to (v5) {};
\path[edge,blue,very thick] (v1) to (v3) {};

\path[edge,orange,very thick] (v4) to (v5) {};
\path[edge,orange,very thick] (v4) to (v7) {};

\path[edge,red,very thick] (v6) to (v9) {};
\path[edge,red,very thick] (v8) to (v9) {};

\path[edge] (v0) to (v3) {};
\path[edge] (v0) to (v6) {};
\path[edge] (v3) to (v6) {};
\path[edge] (v5) to (v8) {};
\path[edge] (v7) to (v8) {};

\draw[->] (5.5,4) -- (8,4) node[midway,above] {Preprocessing};

\begin{scope}[xshift=8.5cm]
\foreach \pos/\name in {{(0.5,5)/3}, {(2.5,2)/5}, {(3,5.5)/6}, {(4,2.5)/8}}
  \node[vertexpt] (w\name) at \pos {};
\node[vertex] (w0) at (0.5,6.5) {$s$};
\node[vertex] (w7) at (4,0.5) {$t$};

\path[edge,red,very thick] (w6) to (w8) {};

\path[edge,blue,very thick] (w3) to (w5) {};

\path[edge,orange,very thick] (w5) to (w7) {};

\path[edge] (w0) to (w3) {};
\path[edge] (w0) to (w6) {};
\path[edge] (w3) to (w6) {};
\path[edge] (w5) to (w8) {};
\path[edge] (w7) to (w8) {};
\end{scope}

\end{tikzpicture}
\end{center}
\subsubsection{Definition}\ssslbl
Seien $G=(V,E)$ Graph, $S:=(U,F)$ Teilgraph von $G$ mit $\vert U\vert\geq1$, $S_i=(U_i,F_i)$ $i=1,\dots,k$ Zusammenhangskomponenten von $S$.\\[1ex]
Ferner $Y=\{y_1,\dots,y_k\}$ zu $(V,U)\cup E$ disjunkte Menge der Kardinalität $k$ und
\begin{align*}
K&=\left\{\{v,w\}\::\:v,w\in V\setminus U\right\}\cap E\\
&\cup\bigcup_{\overset{i,j=1}{i\neq j}}^k\left\{\{y_i,y_j\}\::\:\exists(u_i\in U_i\:\wedge\:u_j\in U_j)\::\:\{u_i,u_j\}\in E\right\}\\
&\cup\bigcup_{i=1}^k\left\{\{y_i,v\}\::\:v\in V\setminus U\:\wedge\:\exists u_i\in U_i\::\:\{u_i,v\}\in E\right\}
\end{align*}
Dann heißt $((V\setminus U)\cup Y,K)$ \textit{Kontraktion}\index{Kontraktion}\index{Kontraktion} von $S$ in $G$. Bezeichnung $G/S$
\subsubsection{Lemma}\ssslbl
$G_i=(V_i,E_i)$ ($i=1,2$) Graphen. $G_1$ $G_2$ sind genau dann \textit{isomorph}\index{Graph!isomorpher}, wennes eine bijektive Abbildung $\tau:V_1\rightarrow V_2$ gibt, so dass für alle $v,w\in V_1$ gilt
\[\{v,w\}\in E_1\:\Leftrightarrow\:(\tau(v),\tau(w))\in E_2\]
\subsubsection*{Beweis} Übung
\subsubsection{Bezeichnung}\ssslbl
$G_i=(V_i,E_i)$ ($i=1,2$) Graphen, $\tau:V_1\rightarrow V_2$ Bijektion mit $\{v,w\}\in E_1\:\Leftrightarrow\:\{\tau(v),\tau(w)\}\in E_2$ für alle $v,w\in V_1$. Dann heißt $\tau$ \textit{Isomorphismus}\index{Isomorphismus} und für $G_1=G_2$ \textit{Automorphismus}\index{Automorphismus}.
\subsubsection{Forschungsproblem}\ssslbl
Gibt es ein Polynom $\Psi:\mathbb R\rightarrow\mathbb R$ und allgemeinen Algorithmus, der für beliebige Graphen $G_1$, $G_2$ in einer durch $\Psi(\vert V_1\vert)$ beschränkten Anzahl von Rechenoperationen entscheidet, ob $G_1$ und $G_2$ isomorph sind.\hfill\textbf{28.10.2008}
\subsubsection*{Beispiel}
Kontraktion ladida
\subsubsection{Definition}\ssslbl
$G=(V,E)$ mit
\[v\in V\:\wedge\:w\in V\setminus\{v\}\:\Rightarrow\:\{v,w\}\in E\]
$G$ heißt \textit{vollständig}\index{Graph!vollständiger}. $K_V$, für $n=\vert V\vert$ oft $K_n$
\subsubsection{Bemerkung}\ssslbl
$G=(V,E)$ vollständig. Dann $\vert E\vert=\binom{\vert V\vert}2$
\subsubsection{Beispiel}\ssslbl
\begin{center}
\begin{tikzpicture}
\matrix[row sep=0mm,column sep=5mm]{
  \node [vertexpt] {}; &

  \foreach \n/\angle in {{1/0},{2/180}}
    \node (v_\n) [vertexpt] at (\angle:7mm) {};
  \foreach \i in {1,...,2} {
    \foreach \j in {\i,...,2}
      \path [edge] (v_\i) to (v_\j);
  } &
  
  \foreach \n/\angle in {{1/90},{2/210},{3/330}}
    \node (v_\n) [vertexpt] at (\angle:7mm) {};
  \foreach \i in {1,...,3} {
    \foreach \j in {\i,...,3}
      \path [edge] (v_\i) to (v_\j);
  } &
  
  \foreach \n/\angle in {{1/45},{2/135},{3/225},{4/315}}
    \node (v_\n) [vertexpt] at (\angle:7mm) {};
  \foreach \i in {1,...,4} {
    \foreach \j in {\i,...,4}
      \path [edge] (v_\i) to (v_\j);
  } &

  \foreach \n/\angle in {{1/90},{2/210},{3/330}}
    \node (v_\n) [vertexpt] at (\angle:7mm) {};
  \node (v_4) [vertexpt] {};
  \foreach \i in {1,...,4} {
    \foreach \j in {\i,...,4}
      \path [edge] (v_\i) to (v_\j);
  } &

  \foreach \n/\angle in {{1/90},{2/162},{3/234},{4/306},{5/18}}
    \node (v_\n) [vertexpt] at (\angle:7mm) {};
  \foreach \i in {1,...,5} {
    \foreach \j in {\i,...,5}
      \path [edge] (v_\i) to (v_\j);
  }\\
  
  \node {$K_1$}; & \node {$K_2$}; & \node {$K_3$}; & \node {$K_4$}; & \node {$K_4$}; & \node {$K_5$};\\
};
\end{tikzpicture}
\end{center}
\subsubsection{Definition}\ssslbl
$G=(V,E)$ Graph. Dann heißt $G$ \textit{Baum}\index{Baum}, wenn $G$ zusammenhängend und kreisfrei ist. $G$ heißt \textit{Wald}\index{Wald}, wenn $G$ kreisfrei ist. Ist $G$ Baum so heißt jeder Knoten $v$ von $G$ mit $deg(v)=1$ \textit{Blatt}\index{Blatt}.\\[1ex]
Teilgraph $T=(V_T,E_T)$ eines Graphen $G$ heißt \textit{aufspannender Baum}\index{Baum!aufspannender} oder \textit{Spannbaum}\index{Spannbaum}, falls $T$ Baum ist und $V=V_T$ gilt.
\subsubsection{Bemerkung}\ssslbl
$G=(V,E)$ Baum, $\vert E\vert\geq1$. Dann besitzt $G$ mindestens zwei Blätter.
\subsubsection*{Beweis}
Sei $W$ Weg in $G$ maximaler (kombinatorischer) Länge. Endknoten sind Blätter
\subsubsection{Lemma}\ssslbl
$G=(V,E)$. Dann äquivalent:
\begin{enumerate}[(a)]
\item $G$ ist Baum
\item Für je zwei Knoten $v,w\in V$ existiert genau ein $v-w$-Weg.
\item $G$ zusammenhängend, aber für $e\in E$ ist $(V,E\setminus\{e\})$ nicht zusammenhängend.
\item $G$ ist kreisfrei, für $v,w\in V$, $v\neq w$, $e:=\{v,w\}\not\in E$ enthält $(V,E\cup\{e\})$ einen Kreis
\end{enumerate}
\subsubsection*{Beweis}
$a\Rightarrow b$: $G$ zusammenhängend, dh. es existiert mindestens ein $v-w$-Weg. Gäbe es zwei verschiedene, so enthielte G einen Kreis (\textit{\ref{5.1.10}(b)})\\[1ex]
$b\Rightarrow c$: Wäre $(V,E\setminus\{e\})$ zusammenhängend, so wären die beiden Knoten von $e$ durch einen Weg in $(V,E\setminus\{e\})$ verbunden, $e$ verbindet sie in $G$ $\Rightarrow$ Widerspruch: 2 verschiedene Wege\\[1ex]
$c\Rightarrow d$: Enthielte $G$ einen Kreis, so könnte beliebige Kante entfernt wreden ohne Zusammenhang zu verlieren. Wäre für $v,w\in V$, $v\neq w$, $e=\{v,w\}\neq E$ $(V,E\cup\{e\})$ kreisfrei, so wären $v,w$ in $G$ nicht verbunden.\\[1ex]
$d\Rightarrow a$: Enthielte $G$ zwei verschiedene Zusammenhangskomponenten $S_1,S_2$, so könnte zwischen $S_1$ und $S_2$ beliebige Kante eingefügt werden, ohne Kreis zu erzeugen.
\subsubsection{Korollar}\ssslbl
$G=(V,E)$ Baum, $\vert V\vert\geq1$. Dann $\vert E\vert=\vert V\vert-1$
\subsubsection*{Beweis}
vollständige Induktion über $\vert V\vert$, benutze \textit{(\ref{5.1.31})}.
\subsubsection{Korollar}\ssslbl
$G=(V,E)$, $\vert V\vert\geq1$. Dann ist äquivalent
\begin{enumerate}[(a)]
\item $G$ Baum
\item $G$ kreisfrei und $\vert E\vert=\vert V\vert-1$
\item $G$ zusammenhängend und $\vert E\vert=\vert V\vert-1$
\end{enumerate}
\subsubsection*{Beweis}
$a\Rightarrow b\wedge c$: Korollar \textit{(\ref{5.1.33})}\\[1ex]
$b\Rightarrow a$: Sei $T=(V,E_T)$ kantenmaximaler kreisfreier Graph, der $G$ als Teilgraph enthält. Nach \textit{(\ref{5.1.32})(d)} ist $T$ Baum. Aus \textit{(\ref{5.1.33})} folgt $\vert E_T\vert=\vert V\vert-1=\vert E\vert$, also $T=G$\\[1ex]
$c\Rightarrow a$: analog mit $T=(V,E_T)$ kantenminimaler zusammenhängender Teilgraph von $G$.
\subsubsection{Korollar}\ssslbl
$G=(V,E)$ zusammenhängender Graph. Dann besitzt $G$ Spannbaum.
\subsubsection*{Beweis}
Sei $T=(V,E_T)$ zusammenhängender Teilgraph minimaler Kantenzahl: \textit{(\ref{5.1.32})(c)} Baum
\subsubsection{Definition}\ssslbl
$G=(V,E)$ Graph, $M\subset E$.
\begin{enumerate}[(a)]
\item $v\in V$. $v$ wird von $M$ \textit{überdeckt}\index{Knoten!überdeckter}, fals $v\in\bigcup_{e\in M}e$. $M$ \textit{Knotenüberdeckung}\index{Knoten!-überdeckung}, wenn jeder Knoten von $V$ überdeckt wird.
\item $M$ \textit{Paarung}\index{Paarung|see{Matching}}, \textit{Matching}\index{Matching}, wenn gilt
\[\{v_1,w_1\},\{v_2,w_2\}\in M\:\wedge\:\{v_1,w_1\}\cap\{v_2,w_2\}\neq\emptyset\:\Rightarrow\:\{v_1,w_1\}=\{v_2,w_2\}\]
\item \textit{perfektes Matching}\index{Matching!perfektes}, wenn $M$ Matching und Knotenüberdeckung ist
\item $\Phi:E\rightarrow\mathbb R$, $M^*$ Matching heißt \textit{maximales Matching}\index{Matching!maximales}, wenn $M^*$ bez. $\sum_{e\in M}\Phi(e)$ unter allen Matchings $M$ maximal ist. $\Phi\equiv1$: \textit{Kardinalitätsmaximum}\index{Kardinalitätsmaximum}
\end{enumerate}
\subsubsection{Beispiel}\ssslbl
\begin{center}
\begin{tikzpicture}
\foreach \n in {1,...,6}
  \node (v_\n) [vertexpt] at (60*\n:1.5cm) {};
\node (v_7) [vertexpt] {};

\foreach \i/\j in {
    {1/2}, {1/6},
    {2/7},
    {3/4}, {3/5}, {3/7},
    {4/6},
    {5/6}, {5/7}}
  \path [edge] (v_\i) to (v_\j);

\foreach \i/\j in {{1/7},{2/3},{4/5}}
  \path [edge,orange,very thick] (v_\i) to (v_\j);
\end{tikzpicture}\hspace{1cm}
\begin{tikzpicture}
\foreach \n in {1,...,5}
  \node (v_\n) [vertexpt] at (18+72*\n:1.5cm) {};
\node (v_6) [vertexpt] {};

\foreach \i/\j in {
    {1/5}, {1/6},
    {2/3}, {2/4}, {2/5}, {2/6},
    {4/5}, {4/6}}
  \path [edge] (v_\i) to (v_\j);

\foreach \i/\j in {{1/2},{3/4},{5/6}}
  \path [edge,red,very thick] (v_\i) to (v_\j);
\end{tikzpicture}\vspace{1em}\\
\emph{\textcolor{orange}{Matching} und \textcolor{red}{perfektes Matching}}
\end{center}
\subsubsection{Definition}\ssslbl
$G=(V,E)$ heißt \textit{bipartit}\index{Graph!bipartiter}, wenn es Partition $V_1,V_2$ von $V$ gibt mit
\[\{v,w\}\in E\:\Rightarrow\:\{v,w\}\cap V_1\neq\emptyset\:\wedge\:\{v,w\}\cap V_2\neq\emptyset\]
Gilt  $(v_1\in V_1\wedge v_2\in V_2$ $\Rightarrow$ $\{v_1,v_2\}\in E$), dann heißt $G$ \textit{vollständig bipartit}\index{Graph!bipartiter!vollständig}; $n_1=\vert V_1\vert$, $n_2=\vert V_2\vert$: $K_{n_1,n_2}$
\subsubsection{Erinnerung}\ssslbl
$P_1,\dots,P_4$ Geschlecht $\Gamma_1$, $Q_1,\dots, Q_3$, $\Gamma_2$, $\Gamma_1\neq\Gamma_2$, Kompatibilitätskoeffizienten $\gamma_{ij}$, $V_1:=\{v_1,\dots,v_4\}$, $V_2:=\{v_5,v_6,v_7\}$, Kanten $E=\{\{v_i,v_j\}\::\:i=1,\dots,4\:\wedge\:j=4,5,6\}$ $\Rightarrow$ $K_{4,3}$, $\Phi(\{v_i,v_j\})=\gamma_{ij}$. Gesucht: maximales Matching.
\subsubsection{Lemma}\ssslbl
$G=(V,E)$ Graph. $G$ bipartit, wenn $G$ keinen Kreis ungerader Länge enthält.\hfill\textbf{31.10.2008}
\subsubsection*{Beweis}
\begin{itemize}
\item[$\Rightarrow$] $\checkmark$
\item[$\Leftarrow$] Konstruiere Partition, oBdA. $G$ zusammenhängend. Nach \textit{(\ref{5.1.35})} besitzt $G$ Spannbaum $T=(V,E_T)$. Sei $s\in T$. Nach \textit{(\ref{5.1.32})(b)} gibt es zu jedem $v\in V$ genau einen $s-v$-Weg in $T$; $p(v)$ sei seine Länge, setze für $k=0,1$:
\[V_{k+1}:=\{v\in V\::\:p(v)\equiv k\mod2\}\]
$(V_1,V_2)$ Partition.\\[1ex]
Seien $v,w\in V$, $e=\{v,w\}\in E\setminus E_T$. Nach \textit{(\ref{5.1.32})(d)} enthält $(V,E_T\cup\{e\})$ einen Kreis (gerader Länge nach Voraussetzung). Somit:\\[1ex]
$s-v$-Weg und $s-w$-Weg in $T$ haben unterschiedliche Länge $\mod2$. Also liegen $v,w$ in verschiedenen Mengen der Partition.
\end{itemize}
\subsubsection{Bezeichnung}\ssslbl
$G=(V,E,\nu)$ allgemeiner Graph, $U\subset V$. Dann
\begin{align*}
\delta(G,U)&:=\left\{e\in E\::\:\exists(u\in U,v\in V\setminus U)\:\wedge\:\nu(e)\in\{\{u,v\},(u,v)\}\right\}\\
N(G,U)&:=\left\{v\in V\setminus U\::\:\exists(u\in U,e\in E)\::\:\nu(e)\in\{\{u,v\},(u,v)\}\right\}
\end{align*}
$N(G,U)$ Menge der \textit{Nachbarn}\index{Nachbar}, Abkürzung $N(G,v)$, $\delta(G,v)$ für $U=\{v\}$
\subsubsection{Satz von Hall}\ssslbl
$G=(V,E)$ bipartit, $(Y,Z)$ zugehörige Partitionen von $V$. Dann äquivalent:
\begin{enumerate}[(a)]
\item Es gibt Matching $M$ in $G$ mit $\vert M\vert=\vert Y\vert$
\item Für jede Teilmenge $U\subset Y$ gilt $\vert N(G,U)\vert\geq\vert U\vert$
\end{enumerate}
\subsubsection*{Beweis}
(a) $\Rightarrow$ (b): $\checkmark$\\[1ex]
(b) $\Rightarrow$ (a): $M$ kardinalitätsmaximales Matching, aber $\vert M\vert<\vert Y\vert$. Sei $y_1\in Y$, in keiner Kante von $M$ enthalten. Sei $Y_1=\{y_1\}$. Es gilt $\vert N(G,Y_1)\geq\vert Y_1\vert=1$. Seien $z_1\in N(G,Y_1)$, $Z_1=\{z_1\}$, $e_1=\{y_1,z_1\}$, $E_1=\{e_1\}$.\\[1ex]
Wäre $z_1$ in keiner Matchingkante enthalten, so wäre $M\cup\{e\}$ größeres Matching $\Rightarrow$ Widerspruch.\\[1ex]
Seien $y_2\in Y\setminus Y_1$, $m_1=\{y_2,z_1\}\in M$, $Y_2=Y_1\cup\{y_2\}$, $M_1=\{m_1\}$. Nach Voraussetzung gilt $\vert N(G,Y_2)\vert\geq\vert Y_2\vert=2>\vert Z_1\vert$.\\[1ex]
Seien $z_2\in Z\setminus Z_1$, $Z_2=Z_1\cup\{z_2\}$, $e_2\in\delta(G,Y_2)$ mit $z_2\in e_2$, $E_2=E_1\cup\{e_2\}$. Induktiv fortsetzen so weit wie möglich.\\[1ex]
Nach $\vert N(G,Y_i)\vert\geq\vert Y_i\vert=i>i-1=\vert Z_{i-1}\vert$. Letzter hinzukommender Knoten $z_k\in Z$. Abbruch $Y_k\subset Y$, $Z_k\subset Z$, $E_k\subset E\setminus M$\\[1ex]
Sei $T:=(Y_k\cup Z_k,E_k\cup M_{k-1})$.\\[1ex]
Konstruktion: $T$ zusammenhängend, kreisfrei, also Baum. Sei $W$ eindeutig bestimmt, $y_1-z_k$-Weg in $T$. $W$ kann nciht verlängert werden, dh. $z_k$ liegt in keiner Kante von $M$. Setze
\[M^*=(M\setminus M_{k-1})\cup E_k\]
$M^*$ ist Matching. $\vert M^*\vert=\vert M\vert+1$ Widerspruch, somit $\vert Y\vert=\vert M\vert$.
\subsubsection{Korollar: Heiratssatz}\ssslbl
$G=(V,E)$ bipartit, $(V_1,V_2)$ zugehörige Partition von $V$. Es gilt genau dann perfektes Matchin in $G$, wenn für $i=1,2$ gilt
\[U_i\subset V_i\:\Rightarrow\:\vert N(G,U_i)\vert\geq\vert U_i\vert\]
\subsubsection*{Beweis}
\textit{(\ref{5.1.42})}: Für $i=1,2$ gibt es Matching $M_i$ mit $\vert M_i\vert=\vert V_i\vert$. Es folgt $\vert V_1\vert\leq\vert V_2\vert$, $\vert V_1\vert\geq\vert V_2\vert$, also $\Vert V_1\vert=\vert V_2\vert$ und $M_i$ überdeckt ganz $V$.
\subsubsection{Beispiel}\ssslbl
Besitzt $G$ perfektes Matching? Nein, weil $N(G,\{z_3,z_5\})=\{y_4\}$ ladida
\subsubsection{Definition}\ssslbl
$G=(V,E)$, $M$ Matching, $W$ eigentlicher Weg in $G$, Kantenmenge $E_W$, $A:=E_W\setminus M$. $W$ heißt \textit{alternierend}\index{Weg!alternierender} bezüglich $M$, wenn $A$ Matching ist. $W$ heißt \textit{Augmentationsweg}\index{Weg!Augmentations-}\index{Augmentationsweg} bezüglich $M$ in $G$, wenn $W$ alternierend ist und die Endknoten nicht überdeckt werden.
\subsubsection{Bemerkung}\ssslbl
$G=(V,E)$ Graph, $M$ Matching, $W$ Augmentationsweg, Kantenmenge $E_W$, $A:=E_W\setminus M$, $M^*=(M\setminus E_W)\cup A$. Dann ist $M^*$ Matching, $\vert M^*\vert=\vert M\vert+1$.
\subsubsection{Bezeichnung}\ssslbl
$M^*$ gemäß \textit{(\ref{5.1.46})} heißt (mittels $W$) \textit{augmentiertes Matching}\index{Matching!augmentiertes}.
\subsubsection{Lemma}\ssslbl
$G=(V,E)$ Graph, $M$ Matching. $M$ ist genau dann Kardinalitätsmaximum, wenn es keinen Augmentationsweg bezüglich $M$ in $G$ gibt.
\subsubsection*{Beweis}
\begin{itemize}
\item[$\Rightarrow$] folgt aus \textit{(\ref{5.1.46})}
\item[$\Leftarrow$] Sei $M$ nicht maximal. $M^*$ Matching mit $\vert M^*\vert>\vert M\vert$. Seien $F:=(M\setminus M^*)\cup(M^*\setminus M)$, $U=\bigcup_{e\in F}e$, $S:=(U,F)$ nicht leerer Teilgraph von $G$. Es gilt für $u\in U$:\\
$deg_S(u)\leq2$, dh. Zusammenhangskomponenten von $S$ sind Wege und Kreise. Kreise enthalten gleichviele Kanten von $M$ und $M^*$, bei Wegen ist die Differenz höchstens 1. Wegen $\vert M^*\vert\geq\vert M\vert+1$ gibt es Weg in $S$, der eine Kante mehr aus $M^*$ enthält als aus $M$. Das ist gesuchter Augmentationsweg.
\end{itemize}\hfill\textbf{04.11.2008}
\subsubsection{Beispiel}\ssslbl
$G$ bipartit, $M$ Matching. Finde Augmentationsweg (Prolbem: es gibt ia. exponentiell viele Wege)\\[1ex]
Augmentationsweg $W_1=(y_1,z_1,y_3,z_4,y_2,z_3)$, $W_2=(y_1,z_2,y_4,z_5)$\\[1ex]
Was ist mit $\{y_4,z_4\}$? Gibt es Augmentationsweg durch $\{y_4,z_4\}$: $W=(y_1,z_2,y_4,z_4,y_2,z_3)$\\[1ex]
Kreis $K=(y_1,z_2,y_4,z_4,z_1,y_1)$ der Länge 6.\\[1ex]
Weil $W$ Augmentationsweg ist, $z_4$ vorher erreicht war ($W_1$) und weil $K$ gerade Länge hat, muss $W_1$ Augmentationsweg sein $\Rightarrow$ Suche auf Bäume beschränken
\subsubsection{Lemma}\ssslbl
$G=(V,E)$ bipartit, $v_1=w_1=v\in V$, $p,q\in\mathbb N$, $v_p=w_q=w\in V$, $W_1=(v_1,\dots,v_p)$, $W_2=(w_1,\dots,w_q)$ zwei $v-w$-Wege. Sind $u\in V$, $i\in[p]=:\{1,\dots,p\}$, $j\in[q]$, $u=v_i=w_j$, so gilt $i\equiv j\mod2$.
\subsubsection*{Widerspruchsbeweis}
$W_1$, $W_2$ Gegenbeispiele minimaler symmetrischer Differenz der Kantenmengen. Insbesondere: $W_1$, $W_2$ kantendisjunkt. Sei $S$ der aus Knoten und Kanten von $W_1$, $W_2$ gebildete Teilgraph von $G$. $S$ enthält Kreis $K$.\\[1ex]
$W_1(K)$, $W_2(K)$ Kanten von $W_1$, $W_2$ in $K$. $G$ bipartit, dh. $K$ gerader Länge, dh. Kantenzahl von $W_1(K)$, $W_2(K)$ gleiche Parität.\\[1ex]
Sei $W_1'$ der aus $W_1$ durch Ersetzung von $W_1(K)$ durch $W_2(K)$ entstandene Weg. Dann $W_1'$, $W_2$ immer noch Gegebeispiel, aber symmetrische Differenz kleiner $\Rightarrow$ Widerspruch
\subsubsection{Definition}\ssslbl
$G=(V,E)$ bipartit, Partition $(Y,Z)$ von $V$, $y\in Y$, Matching $M$, das $y$ nicht überdeckt. Sei $T=(V_T,E_T)$ maximaler Baum in $G$ mit $y\in V_T$, so dass jeder $y$-Weg in $T$ alternierend ist. Dann heißt $T$ \textit{Augmentationsbaum}\index{Augmentationsbaum}\index{Baum!Augmentations-} zu $y$ in $G$.
\subsubsection{Korollar}\ssslbl
$G=(V,E)$ bipartit, $(Y,Z)$ zugehörige Partition, $y\in Y$, Matching $M$, das $y$ nicht überdeckt, $T=(V_T,E_T)$ Augmentationsbaum zu $y$. Es gibt genau dann einen Augmentationsweg bez. $M$ mit Endknoten $y$ wenn es einen solchen in $T$ gibt.
\subsubsection*{Beweis}
Sei $W$ Augmentationsweg, Endknoten $y,z$. Seien $w$ der von $y$ aus erste Knoten aus $W$, der nicht in $T$ liegt, $v$ sein Vorgänger, $e=\{v,w\}$. Nach \textit{(\ref{5.1.50})} hat $w$ gleichen Abstand $\mod2$ von $y$ wie in $T$. Der alternierende $y-w$-Weg kann somit mittels $e$ verängert werden im Widerspruch zur Maximalität von $T$. Also: alle Knoten von $W$ liegen in $T$, insbesondere $z$. Sei $W_T$ (eindeutig bestimmter) $y-z$-Weg. Da $W$ Augmentationsweg ist, ist nach \textit{(\ref{5.1.50})} auch $W_T$ Augmentationsweg.
\subsubsection{Prozedur: Kantenmaximales Matching in bipartiten Graphen (Grundform)}\ssslbl
\lstset{mathescape=true}
\begin{lstlisting}
INPUT bipartiter Graph $G=(V,E)$, zugehörige Partition $(Y,Z)$
OUTPUT Kantenmaximales Matching $M$
BEGIN $M\leftarrow\emptyset$, $A\leftarrow Y$
   BEGIN WHILE $A\neq\emptyset$ DO
      BEGIN sei $y\in A$, $A\leftarrow A\setminus\{y\}$
         Konstruiere einen Augmentationsbaum $T=(V_T,E_T)$ zu $y$
         IF $T$ enthält Augmentationsweg $W$ THEN
            $M\leftarrow$ mittels $W$ augmentiertes Matching
      END
   END
END
\end{lstlisting}
\subsubsection{Satz}\ssslbl
$G=(V,E)$ bipartit. Dann findet Prozedur \textit{(\ref{5.1.53})} ein kantenmaximales Matching.
\subsubsection*{Beweis}
Jeder Augmentationsweg hat Endknoten in $Y$ und $Z$, dh. Beschränkung auf $Y$ irrelevant. Sei $y$ nicht überdeckt. Augmentation führt zur Überdeckung von $y$; alle vorher überdeckten Knoten bleiben überdeckt. Nach \textit{(\ref{5.1.52})} findet Algorithmus Augmentationsweg solange welche in $G$ existieren. Nach Lemma \textit{(\ref{5.1.48})} $M$ maximal, falls keine Augmentationswege existieren.\\[1ex]
Was ist mit nicht-bipartiten Graphen? Problem: Fehlen von Lemma \textit{(\ref{5.1.50})}
\subsubsection{Beispiel}\ssslbl
ladida
\subsection{Von Basen zu diskreten Strukturen: Matroide}\sslbl
\subsubsection{Definition}\ssslbl
$E$ endliche Menge, $\mathcal I$ nichtleere Teilmenge von $2^E$. Das Paar $(E,\mathcal I)$ heißt \textit{Unabhängigkeitssystem}\index{System!Unabhängigkeits-}, wenn $\mathcal I$ abgeschlossen unter Inklusion ist, dh. ($I\in\mathcal I\wedge J\subset I$ $\Rightarrow$ $J\in\mathcal I$). $E$ \textit{Grundmenge}\index{Grundmenge}, Elemente von $\mathcal I$ \textit{unabhängige Mengen}\index{Mengen!unabhängige}, Elemente von $2^E\setminus\mathcal I$ \textit{abhängig}\index{Mengen!abhängige}. Gilt ferner ($I,J\in\mathcal I\wedge\vert I\vert+1=\vert J\vert$ $\Rightarrow$ $\exists(e\in J\setminus I):I\cup\{e\}\in\mathcal I$), so heißt $(E,\mathcal I)$ \textit{Matroid}\index{Matroid}.
\subsubsection{Bemerkung}\ssslbl
$(E,\mathcal I)$ Unabhängigkeitssystem. Dann gilt\hfill\textbf{07.11.2008}
\begin{enumerate}[(a)]
\item $\emptyset\in\mathcal I$
\item $(E,\mathcal I)$ Matroid, genau dann wenn
\[I,J\in\mathcal I\:\wedge\:\vert I\vert<\vert J\vert\:\Rightarrow\:\exists(e\in J\setminus I):\:I\cup\{v\}\in\mathcal I\]
\end{enumerate}
\subsubsection*{Beweis}
$\checkmark$
\subsubsection{Lemma}\ssslbl
$E_1,\dots,E_4$ endliche Mengen, $\mathcal I_i\subset2^{E_i}$ ($i\in[4]$) definiert durch
\begin{enumerate}[(a)]
\item $\mathcal I_1:=2^{E_1}$
\item $k\in\mathbb N_0$, $\mathcal I_2:=\{I\subset E_2\::\:\vert I\vert\leq k\}$
\item $X$ endlichdimensionaler Vektorraum über Körper $K$, $E_3\subset X$, $\mathcal I_3$ Menge aller linear unanhängigen Teilmengen von $E_3$
\item $s\in\mathbb N$, $\Pi=(A_1,\dots,A_s)$ Partition von $E_4$, $\beta_1,\dots,\beta_s\in\mathbb N_0$
\[\mathcal I_4:=\{I\subset E_4\::\:\vert I\cap A_i\vert\leq\beta_i\:(i=1,\dots,s)\}\]
\end{enumerate}
Dann sind $(E_i,\mathcal I_i)$ Matroide.
\subsubsection*{Beweis}
\begin{itemize}
\item Abgeschlossen bez. Inklusion
\item Austauschbedingung klar für (a), (b), (c)
\item Austauschbedingung für (d): $I,J\in\mathcal I_4$, $\vert I\vert+1=\vert J\vert$. Sei $k\in\mathbb N_0$, $A_1,\dots,A_s$ so nummeriert, dass $\vert I\cap A_i\vert=\beta_i$ ($i=1,\dots,k$), $\vert I\cap A_i\vert<\beta_i$ ($i=k+1,\dots,s$); $X:=A_1\cup\dots\cup A_k$, $Y:=A_{k+1}\cup\dots\cup A_s$.\\[1ex]
Annahme: $J\setminus I\subset X$. Dann $k\geq1$, $J\cap Y=I$, also $\vert J\cap Y\vert\leq\vert I\cap Y\vert$. Vorraussetzung $\vert I\vert<\vert J\vert$ impliziert $\vert J\cap X\vert>\vert I\cap X\vert=\beta_1+\dots+\beta_k$. $J$ verletzt mindestens eine Bedingung. Widerspruch zu $J\in\mathcal I_4$. Also exisitert $i_0\in\{k+1,\dots,s\}$ mit $(J\setminus I)\cap A_{i_0}\neq\emptyset$. Sei $e\in(J\setminus I)\cap A_{i_0}$. Dann $\vert I\cup\{e\}\cap A_{i_0}\vert\leq\beta_{i_0}$, also $I\cup\{e\}\in\mathcal I_4$.
\end{itemize}
\subsubsection{Bezeichnung}\ssslbl
$(E_i,\mathcal I_i)$ wie oben. $(E_1,\mathcal I_1)$ \textit{freies Matroid}\index{Matroid!freies}, $(E_2,\mathcal I_2)$ \textit{uniformes Matroid}\index{Matroid!uniformes}, $(E_3,\mathcal I_3)$ \textit{vektorielles Matroid}\index{Matroid!vektorielles}\index{Matroid!Matrix-}, $(E_4,\mathcal I_4)$ \textit{Partitionsmatroid}\index{Matroid!Partitions-}.
\subsubsection{Bemerkung}\ssslbl
$(E,\mathcal I)$ Unabhängigkeitssystem, $A\subset E$, $\mathcal I_A:=\{I\in\mathcal I\::\:I\subset A\}$
\begin{enumerate}[(a)]
\item $(A,\mathcal I_A)$ ist Unabhängigkeitssystem
\item Ist $(E,\mathcal I)$ Matroid, so auch $(A,\mathcal I_A)$
\end{enumerate}
\subsubsection*{Beweis}
$\checkmark$
\subsubsection{Bezeichnung}\ssslbl
$(A,\mathcal I_A)$ durch $A$ \textit{induziertes Unabhängigkeitssystem / Matroid}\index{Matroid!induziertes}\index{System!Unabhängigkeits-!induziertes}.
\subsubsection{Bezeichnung}\ssslbl
$X_1,X_2$ Mengen, $\theta:X_1\rightarrow X_2$. Dann $\Theta:2^{X_1}\rightarrow2^{X_2}$ definiert durch $\Theta(I):=\{\theta(x)\::\:x\in I\}$ \textit{natürliche Erweiterung}\index{Erweiterung!natürliche} von $\theta$.
\subsubsection{Bemerkung}\ssslbl
$(E_1,\mathcal I_1)$ Unabhängigkeitssystem / Matroid, $E_2$ endliche Menge $\theta:E_1\rightarrow E_2$ Bijektion, $\Theta$ natürliche Erweiterung, $\mathcal I_2:=\{\Theta(I)\::\:I\in\mathcal I_1\}$. Dann $(E_2,\mathcal I_2)$ Unabhängigkeitssystem / Matroid.
\subsubsection*{Beweis}
Bijektivität von $\theta$ überträgt sich auf $\Theta$.
\subsubsection{Korollar}\ssslbl
$G=(V,E)$ Graph, $V=\{v_1,\dots,v_n\}$, $E=\{e_1,\dots,e_m\}$, $m\geq1$, $Z\subset\mathbb Z_2^n$ Menge der Inzidenzvektoren der Kanten (Spalten von $S_G$). $\theta:Z\rightarrow E$ ordnet Inzidenzvektor seiner Kante zu, $(Z,\mathcal I)$ vektorielles Matroid, $\mathcal F:=\Theta(\mathcal I)$. Dann ist $(E,\mathcal F)$ ein Matroid.
\subsubsection*{Beweis}
direkt aus \textit{(\ref{5.2.8})}
\subsubsection{Beispiel}
$G=(V,E)$
\begin{center}
\begin{tikzpicture}
\tikzstyle{every loop}=[]
\foreach \name/\j in {{5/0},{2/1},{1/2},{4/3},{6/4}}
  \node[vertex] (v\name) at (72*\j:2cm) {$v_\name$};
\node[vertex] (v3) at (0,0) {$v_3$};

\path[edge] (v1) to (v2) node[midway,above] {$e_1$};
\path[edge] (v1) to (v3) node[midway,above right] {$e_2$};
\path[edge] (v1) to (v4) node[midway,left] {$e_3$};
\path[edge] (v2) to (v3) node[midway,below right] {$e_4$};
\path[edge] (v3) to (v4) node[midway,below right] {$e_5$};
\path[edge] (v2) to (v5) node[midway,right] {$e_6$};
\path[edge] (v4) to (v6) node[midway,below] {$e_7$};
\path[edge] (v5) to (v6) node[midway,below right] {$e_8$};
\end{tikzpicture}
\end{center}
\[S_G=\left(\begin{array}{cccccccc}
1 & 1 & 1 & 0 & 0 & 0 & 0 & 0 \\ 
\textcolor{orange}1 & 0 & 0 & 1 & 0 & 1 & 0 & 0 \\ 
0 & \textcolor{orange}1 & 0 & 1 & 1 & 0 & 0 & 0 \\ 
0 & 0 & \textcolor{orange}1 & 0 & 1 & 0 & 1 & 0 \\ 
0 & 0 & 0 & 0 & 0 & \textcolor{orange}1 & 0 & 1 \\ 
0 & 0 & 0 & 0 & 0 & 0 & \textcolor{orange}1 & 1
\end{array} \right)\qquad rang(S_G)=5\]
abhängig:
\begin{center}
\begin{tikzpicture}
\tikzstyle{every loop}=[]
\foreach \name/\j in {{5/0},{2/1},{1/2},{4/3},{6/4}}
  \node[vertexpt] (v\name) at (72*\j:1cm) {};
\node[vertexpt] (v3) at (0,0) {};

\path[edge] (v1) to (v2);
\path[edge] (v1) to (v3);
\path[edge] (v2) to (v3);
\end{tikzpicture}
\hspace{1cm}
\begin{tikzpicture}
\tikzstyle{every loop}=[]
\foreach \name/\j in {{5/0},{2/1},{1/2},{4/3},{6/4}}
  \node[vertexpt] (v\name) at (72*\j:1cm) {};
\node[vertexpt] (v3) at (0,0) {};

\path[edge] (v1) to (v2);
\path[edge] (v1) to (v4);
\path[edge] (v2) to (v3);
\path[edge] (v3) to (v4);
\end{tikzpicture}
\hspace{1cm}
\begin{tikzpicture}
\tikzstyle{every loop}=[]
\foreach \name/\j in {{5/0},{2/1},{1/2},{4/3},{6/4}}
  \node[vertexpt] (v\name) at (72*\j:1cm) {};
\node[vertexpt] (v3) at (0,0) {};

\path[edge] (v1) to (v2);
\path[edge] (v1) to (v4);
\path[edge] (v2) to (v5);
\path[edge] (v4) to (v6);
\path[edge] (v5) to (v6);
\end{tikzpicture}
\end{center}
unabhängig:
\begin{center}
\begin{tikzpicture}
\tikzstyle{every loop}=[]
\foreach \name/\j in {{5/0},{2/1},{1/2},{4/3},{6/4}}
  \node[vertexpt] (v\name) at (72*\j:1cm) {};
\node[vertexpt] (v3) at (0,0) {};

\path[edge] (v1) to (v4);
\path[edge] (v2) to (v3);
\path[edge] (v3) to (v4);
\path[edge] (v4) to (v6);
\path[edge] (v5) to (v6);
\end{tikzpicture}
\hspace{1cm}
\begin{tikzpicture}
\tikzstyle{every loop}=[]
\foreach \name/\j in {{5/0},{2/1},{1/2},{4/3},{6/4}}
  \node[vertexpt] (v\name) at (72*\j:1cm) {};
\node[vertexpt] (v3) at (0,0) {};

\path[edge] (v1) to (v3);
\path[edge] (v1) to (v4);
\path[edge] (v2) to (v3);
\path[edge] (v4) to (v6);
\path[edge] (v5) to (v6);
\end{tikzpicture}
\hspace{1cm}
\begin{tikzpicture}
\tikzstyle{every loop}=[]
\foreach \name/\j in {{5/0},{2/1},{1/2},{4/3},{6/4}}
  \node[vertexpt] (v\name) at (72*\j:1cm) {};
\node[vertexpt] (v3) at (0,0) {};

\path[edge] (v1) to (v3);
\path[edge] (v1) to (v4);
\path[edge] (v2) to (v5);
\path[edge] (v5) to (v6);
\end{tikzpicture}
\end{center}
\subsubsection{Lemma}\ssslbl
$G=(V,E)$, $(E,\mathcal F)$ zugehöriges vektorielles Matroid über $\mathbb Z_2$, $T\subset E$. $T$ ist genau dann unabhängig, wenn $(V,T)$ kreisfrei ist.
\subsubsection*{Beweis}
Übung
\subsubsection{Bezeichnung}\ssslbl
$(E,\mathcal F)$ wie oben: \textit{graphisches Matroid}\index{Matroid!graphisches}.
\subsubsection{Definition}\ssslbl
$U=(E,\mathcal I)$ Unabhängigkeitssystem. Jede (inklusions-)maximale unabhängige Menge aus $\mathcal I$ heißt \textit{Basis}\index{Basis}.\\
Jede (inklusions-)minimale abhängige Menge heißt \textit{Kreis}\index{Kreis}.
\begin{align*}
r_+(U)&:=\max\{\vert B\vert\::\:B\text{ Basis}\}\\
r_-(U)&:=\min\{\vert B\vert\::\:B\text{ Basis}\}
\end{align*}
$r_+(U)$ \textit{oberer Rang}\index{Rang!oberer}, $r_-(U)$ \textit{unterer Rang}\index{Rang!unterer}\\[1ex]
$r(U):=r_+(U)=r_-(U)$ \textit{Rang}\index{Rang}.
\subsubsection{Lemma}\ssslbl
$U=(E,\mathcal I)$ Unabhängigkeitssystem. $U$ Matroid genau dann wenn für jedes $A\subset E$ und $U_A=(A,\mathcal I_A)$ gilt
\[r_+(U_A)=r_-(U_A)\]
Insbesondere haben alle Basen gleiche Kardinalität.
\subsubsection*{Beweis}
\begin{itemize}
\item[$\Rightarrow$] folgt aus Austauschbedingung
\item[$\Leftarrow$] Seien $I,J\in\mathcal I$, $\vert I\vert+1=\vert J\vert$. $A:=I\cup J$. Es gilt $I,J\in\mathcal I_A$. Wegen $\vert I\vert<\vert J\vert$ und $r_+(U_A)=r_-(U_A)$, kann $I$ nicht maximal unabhängig sein. Es existiert $e\in A\setminus I=J\setminus I$ mit $I\cup\{e\}\in\mathcal I_A\subset\mathcal I$
\end{itemize}
\subsubsection{Lemma}\ssslbl
$M=(E,\mathcal I)$ Matroid, $I\in\mathcal I$, $e\in E$, $I\cup\{e\}\not\in\mathcal I$. Dann enthält $I\cup\{e\}$ genau einen Kreis.
\subsubsection*{Beweis}
Da $I\cup\{e\}$ abhängig, enthält $I\cup\{e\}$ Kreis. Seien $K_1,K_2$ zwei verschiedene Kreise in $I\cup\{e\}$. Da $I\in\mathcal I$ und $(K_1\cup K_2)\setminus\{e\}\subset I$ folgt $e\in K_1\cap K_2$, $(K_1\cup K_2)\setminus\{e\}\in\mathcal I$. Sei $a\in K_1\setminus K_2$. Dann $K_1\setminus\{a\}\in\mathcal I$. Austauschbedingung auf $K_1\setminus\{a\}$, $(K_1\cup K_2)\setminus\{e\}$ anwenden: liefert $J\in\mathcal I$: $K_1\setminus\{a\}\subset J\subset K_1\cup K_2$ und $\vert J\vert=\vert(K_1\cup K_2)\setminus\{e\}\vert$. Sei $\{b\}=(K_1\cup K_2)\setminus J$. Falls $b=a$ ($\in K_1\setminus K_2$) folgt $K_2\subset J$, dh. $K_2\in\mathcal I$ Widerspruch. Also $b\neq a$.\\[1ex]
Wegen $a\in K_1$ folgt $a\in J$. Ferner $K_1\setminus\{a\}\subset J$, also $K_1\subset J$ Widerspruch zu $K_1\in 2^E\setminus\mathcal I$.
\subsubsection{Definition}\ssslbl
\textit{Maximierungsaufgabe}\index{Maximierungsaufgabe} über Unabhängigskeitssystem / Matroid spezifiziert Unabhängigkeitssystem bzw. Matroid $(E,\mathcal I)$, $\Phi:E\rightarrow[0,\infty[$. Sei $\varphi:\mathcal I\rightarrow[0,\infty[$ definiert durch $\varphi(I):=\sum_{e\in I}\Phi(e)$. Gesucht $I^*$ mit $\varphi(I^*)=\max_{I\in\mathcal I}\varphi(I)$.
\subsubsection{Prozedur: Greedy-Algorithmus\index{Greedy-Algorithmus}}\ssslbl\hfill\textbf{11.11.2008}
\begin{lstlisting}
INPUT Unabhängigkeitssystem $(E,\mathcal I)$, $\Phi:E\rightarrow[0,\infty[$
OUTPUT $I^g\in\mathcal I$
BEGIN $A\leftarrow E$, $I^g\leftarrow\emptyset$
   WHILE $A\neq\emptyset$ DO
      BEGIN
         Wähle $a\in argmax_{e\in A}\Phi(e)$
         $A\leftarrow A\setminus\{a\}$
         IF $I^g\cup\{a\}\in\mathcal I$ THEN
            $I^g\leftarrow I^g\cup\{a\}$
      END
END
\end{lstlisting}
\subsubsection{Bezeichnung}\ssslbl
$I^g$ heißt \textit{Greedy-Lösung}\index{Greedy-Lösung}.
\subsubsection*{Bemerkung}
\begin{enumerate}[(1)]
\item Wähle $a\in argmax$ kann durch Vorsortieren erledigt werden (in $\vert E\vert\log\vert E\vert$)
\item Greedy-Algorithmus optimal lokal ohne Rücksicht darauf, welchen Einfluss diese Wahl auf spätere Entscheidungen hat.
\end{enumerate}
\subsubsection{Beispiel}\ssslbl
\begin{center}
\begin{tikzpicture}
\foreach \n/\pos in {{1/(0,2)}, {2/(2,0)}, {3/(2,4)}, {4/(4,1)}, {5/(4,3)}, {6/(6,0)}, {7/(6,4)}, {8/(7,2)}, {9/(8,0)}, {10/(8,4)}, {11/(10,2)}}
  \node (v\n) [vertexpt] at \pos {};

\path[edge] (v1) to (v2) node[midway,below left] {2};
\path[edge] (v1) to (v4) node[midway,below] {1};
\path[edge] (v1) to (v3) node[midway,above left] {1};
\path[edge] (v4) to (v5) node[midway,left] {2};
\path[edge] (v3) to (v5) node[midway,above right] {5};
\path[edge] (v4) to (v6) node[midway,above right] {8};
\path[edge] (v4) to (v8) node[midway,above] {1};
\path[edge] (v5) to (v8) node[midway,above] {2};
\path[edge] (v6) to (v9) node[midway,below] {2};
\path[edge] (v8) to (v9) node[midway,above right] {2};
\path[edge] (v7) to (v10) node[midway,above] {2};

\path[edge,orange,very thick] (v1) to (v5) node[midway,above,orange] {$8_4$};
\path[edge,orange,very thick] (v2) to (v4) node[midway,below right,orange] {$8_3$};
\path[edge,orange,very thick] (v2) to (v6) node[midway,below,orange] {$9_1$};
\path[edge,orange,very thick] (v5) to (v7) node[midway,above left,orange] {$5_6$};
\path[edge,orange,very thick] (v3) to (v7) node[midway,above,orange] {$5_7$};
\path[edge,orange,very thick] (v6) to (v8) node[midway,above left,orange] {$3_8$};
\path[edge,orange,very thick] (v7) to (v8) node[midway,above right,orange] {$9_2$};
\path[edge,orange,very thick] (v9) to (v11) node[midway,below right,orange] {$6_5$};
\path[edge,orange,very thick] (v8) to (v11) node[midway,above,orange] {$2_9$};
\path[edge,orange,very thick] (v10) to (v11) node[midway,above right,orange] {$2_{10}$};
\end{tikzpicture}\vspace{1em}\\
\emph{\textcolor{orange}{eine Greedy-Lösung}}
\end{center}
\subsubsection{Beispiel}\ssslbl
$m\geq4$, $E=\{e_1,\dots,e_m\}$, $\mathcal I$ bestehe aus $\{e_1\}$ und Potenzmenge von $\{e_2,\dots,e_m\}$. $(E,\mathcal I)$ Unabhängigkeitssystem.\\[1ex]
Sei $\gamma\in[0,\infty[$, $\Phi:E\rightarrow[0,\infty[$ definiert durch
\[\Phi(e)=\begin{cases}\gamma+1&e=e_1\\\gamma&\text{sonst}\end{cases}\]
$I^g=\{e_1\}$, $\varphi(I^g)=\gamma+1$, $I^*:=\{e_2,\dots,e_m\}$, $\varphi(I^*)=\gamma(m-1)$. Sei $\gamma>\frac1{m-2}$. Dann $I^*$ optimal. Es gilt
\[\frac{\varphi(I^g)}{\varphi(I^*)}=\frac{\gamma+1}{\gamma(m-1)}=\left(1+\frac1{\gamma}\right)\frac1{m-1}\in\left]\frac1{m-1},1\right]\]
Beachte $r_-(U)=1$, $r_+(U)=m-1$, $U=(E,\mathcal I)$.
\subsubsection{Bezeichnung}\ssslbl
$U=(E,\mathcal I)$ Unabhängigkeitssystem. Für $A\subset E$ setze
\[\kappa(A)=\begin{cases}1&\text{falls }r_+(U_A)=0\\\frac{r_-(U_A)}{r_+(U_A)}&\text{sonst}\end{cases}\]
Dann $\rho=\min\{\kappa(A)\::\:A\subset E\}$ \textit{Rangquotient}\index{Rangquotient} von $U$.
\subsubsection{Lemma}\ssslbl
Seien $E=\{e_1,\dots,e_m\}$, $I\in2^E$, $\Phi:E\rightarrow\mathbb R$; für $j=1,\dots,m$ setze $E_j=\{e_1,\dots,e_j\}$, $I_j=I\cap E_j$. Formale Setzung $\Phi(e_{m+1})=0$ für $e_{m+1}\not\in E$. Dann
\[\sum_{e\in I}\Phi(e)=\sum_{j=1}^m\left(\Phi(e_j)-\Phi(e_{j+1})\right)\cdot\vert I_j\vert\]
\subsubsection*{Beweis}
Es gilt
\[\vert I_j\vert-\vert I_{j-1}\vert=1\:\Leftrightarrow\:e_j\in I_j\setminus I_{j-1}\]
Es folgt
\[\sum_{e\in I}\Phi(e)=\sum_{j=1}^m\Phi(e_j)(\vert I_j\vert-\vert I_{j-1}\vert)=\sum_{j=1}^m(\Phi(e_j)-\Phi(e_{j+1}))\vert I_j\vert\]
\subsubsection{Satz}\ssslbl
$(E,\mathcal I,\Phi)$ spezifiziert Maximalitätsaufgabe über Unabhängigkeitssystem $U=(E,\mathcal I)$, $\varphi$ zugehörige Zielfunktion, $I^*$ optimale Lösung, $I^g$ Greedy-Lösung. Dann $\varphi(I^g)\geq\rho(U)\varphi(I^*)$. Es gibt $\Phi$ mit $=$.
\subsubsection*{Beweis}
oBdA $E\neq\emptyset$. Sei $E=\{e_1,\dots,e_m\}$ mit $\Phi(e_1)\geq\dots\geq\Phi(e_m)$. $E_j=\{e_1,\dots,e_j\}$, $U_j=U_{E_j}$. Für $I\in\mathcal I$: $I_j:=I\cap E_j$.\\[1ex]
Nach Voraussetzung gilt für $j=1,\dots,m$ $r_-(U_j)\leq\vert I_j^g\vert$, $\vert I_j^*\vert\leq r_+(U_j)$.\\[1ex]
Doppelte Anwendung von \textit{(\ref{5.2.22})}:
\begin{align*}
\varphi(I^g)=\sum_{j=1}^m\underbrace{(\Phi(e_j)-\Phi(e_{j+1}))}_{\geq0}\vert I_j^g\vert&\geq\sum_{j=1}^m(\Phi(e_j)-\Phi(e_{j+1}))r_-(U_j)\\
&\geq\rho(U)\sum_{j=1}^m(\Phi(e_j)-\Phi(e_{j+1}))r_+(U_j)\\
&\geq\rho(U)\sum_{j=1}^m(\Phi(e_j)-\Phi(e_{j+1}))\vert  I_j^*\vert\\
&=\rho(U)\varphi(I^*)
\end{align*}
\subsubsection*{Beispiel $=$}
Sei $A^*\subset E$ mit $\kappa(A^*)=\min\{\kappa(A)\::\:A\subset E\}$
\[\Phi(e):=\begin{cases}1&e\in A^*\\0&e\in E\setminus A^*\end{cases}\]
Seien $I,J$ Basen in $U_{A^*}$ mit $\vert I\vert=r_-(U_{A^*})$, $\vert J\vert=r_+(U_{A^*})$. Wird Reihenfolge der Elemente von $E$ so gewählt, dass zunächst die von $I$, dann die von $J\setminus I$ und dann die von $E\setminus A^*$ gewählt werden, so erzeugt der Greedy-Algorithmus $I$, obwohl $\vert J\vert$ optimal ist.
\subsubsection{Bemerkung}\ssslbl
Abschätzung auch dann nicht substantiell verbesserbar wenn Greedy-Algorithmus stets das Beste nächstmögliche Element wählt.
\subsubsection*{Idee}
$I=\{e_1,\dots,e_k\}$, $k=r_-(U_{A^*})$, $\vert J\vert=r_+(U_{A^*})$, $J\vert I=\{e_{k+1},\dots,e_l\}$, $E\setminus(I\cup J)=\{e_{l+1},\dots,e_m\}$, $\epsilon\in]0,1[$. Wir setzen
\[\Phi(e_j)=\begin{cases}1+\epsilon^j&j=1,\dots,l\\0&j=l+1,\dots,m\end{cases}\]
\subsubsection{Korollar: Edmonds-Rado Theorem\index{Theorem!Edmonds-Rado}}\ssslbl
Sei $(E,\mathcal I)$ Unabhängigkeits System. $(E,\mathcal I)$ ist genau dann Matroid, wenn der Greedy-Algorithmus für jede $\Phi:E\rightarrow[0,\infty[$ ein Optimum der durch $(E,\mathcal I,\Phi)$ spezifizierte Maximierungsaufgabe über Unabhängigkeitssysteme findet.
\subsubsection*{Beweis}
\textit{(\ref{5.2.14})}, \textit{(\ref{5.2.23})}
\subsubsection{Beispiel}\ssslbl
maximales Matching, $G=(V,E,\Phi)$, $\alpha\in\mathbb N\setminus\{1,2\}$
\begin{center}
\begin{tikzpicture}
\foreach \n in {0,...,3}
  \node (v\n) [vertexpt] at (90*\n:1.5cm) {};

\path[edge] (v0) to (v1) node[midway,above right] {$\alpha$};
\path[edge] (v1) to (v2) node[midway,above left] {$\alpha+1$};
\path[edge] (v2) to (v3) node[midway,below left] {$\alpha$};
\path[edge] (v3) to (v0) node[midway,below right] {$1$};
\end{tikzpicture}
\hspace{1cm}
\begin{tikzpicture}
\foreach \n in {0,...,3}
  \node (v\n) [vertexpt] at (90*\n:1.5cm) {};

\path[edge,orange,very thick] (v1) to (v2) node[midway,above left,orange] {$\alpha+1$};
\path[edge,orange,very thick] (v3) to (v0) node[midway,below right,orange] {$1$};
\end{tikzpicture}
\hspace{1cm}
\begin{tikzpicture}
\foreach \n in {0,...,3}
  \node (v\n) [vertexpt] at (90*\n:1.5cm) {};

\path[edge,red,very thick] (v0) to (v1) node[midway,above right,red] {$\alpha$};
\path[edge,red,very thick] (v2) to (v3) node[midway,below left,red] {$\alpha$};
\end{tikzpicture}
\vspace{1em}\\
\emph{\textcolor{orange}{$I^g$ ($\alpha+2$)} und \textcolor{red}{$I^*$ ($2\alpha$)}}
\end{center}
Matching $\rightarrow$ Unabhängigkeitssystem
\[\varphi(I^g)<\varphi(I^*)\]
mit \textit{(\ref{5.2.24})} folgt: kein Matroid\\[1ex]
Hier gilt: $\alpha+2=\varphi(I^g)\geq\frac12\varphi(I^*)=\alpha$\begin{center}
\begin{tikzpicture}
\foreach \n in {0,...,3}
  \node (v\n) [vertexpt] at (90*\n:1.5cm) {};

\path[edge] (v0) to (v1) {};
\path[edge] (v1) to (v2) {};
\path[edge] (v2) to (v3) {};
\end{tikzpicture}
\hspace{1cm}
\begin{tikzpicture}
\foreach \n in {0,...,3}
  \node (v\n) [vertexpt] at (90*\n:1.5cm) {};

\path[edge,orange,very thick] (v0) to (v1) {};
\path[edge] (v1) to (v2) {};
\path[edge,orange,very thick] (v2) to (v3) {};
\end{tikzpicture}
\hspace{1cm}
\begin{tikzpicture}
\foreach \n in {0,...,3}
  \node (v\n) [vertexpt] at (90*\n:1.5cm) {};

\path[edge] (v0) to (v1) {};
\path[edge,red,very thick] (v1) to (v2) {};
\path[edge] (v2) to (v3) {};
\end{tikzpicture}
\vspace{1em}\\
\emph{Rangquotient $A$; \textcolor{orange}{$r_+(U_A)=2$} und \textcolor{red}{$r_-(U_A)=1$}}
\end{center}
\subsubsection{Lemma}\ssslbl
$G=(V,E,\Phi)$ gewichteter Graph mit $\Phi\geq0$, $\mathcal I$ Menge aller Matching von $G$, $\varphi(M)=\sum_{e\in M}\Phi(e)$ für $M\in\mathcal I$, $U=(E,\mathcal I)$. Ferner $I^*$ maximal (bez. $\varphi$), $I^g$ Greedy-Lösung. Dann gilt $2\varphi(I^g)\geq\varphi(I^*)$
\subsubsection*{Beweis}
Zeige $r_+(U_A)\leq2r_-(U_A)$ für $\emptyset\neq A\subset E$.\\[1ex]
Annahme: Sei $A\subset E$, $I_1$, $I_2$ maximal unabhängig in $U_A$ mit $\vert I_1\vert=r_-(U_A)$, $\vert I_2\vert=r_+(U_A)$ und $r_+(U_A)\geq2r_-(U_A)+1$. Sei $V_k:=\bigcup_{e\in I_k}e$ ($k=1,2$). Es gilt
\[\vert V_2\vert=2\vert I_2\vert=2r_+(U_A)\geq2\bigl(2r_-(U_A)+1\bigr)=4\vert I_1\vert+2=2\vert V_1\vert+2\]
Also: Es gibt $e\in I_2$, die 2 Knoten aus $V_2\setminus V_1$ verbindet. Es folgt $I_1\cup\{e\}\in\mathcal I$.\\[1ex]
Widerspruch: Also $\rho(U)\geq\frac12$. Behauptung folgt aus \textit{(\ref{5.2.23})}.
\subsubsection{Bemerkung}\ssslbl
$G=(V,E)$ Graph, $\mathcal I$ Menge aller $I\subset V$, so dass Matching existiert, das $I$ überdeckt. Dann ist $(V,\mathcal I)$ Matroid.
\subsubsection*{Beweis}
Übung
\subsubsection{Definition}\ssslbl
$(E,\mathcal I)$ Unabhängikeitssystem. $\mathcal B=\bigl\{I\in\mathcal I\::\:I\text{ Basis}\bigr\}$, $(E,\mathcal B)$ (zugehöriges) \textit{Basissystem}\index{System!Basis-}. \textit{Minimierungsaufgabe}\index{Minimierungsaufgabe} über Basissystem.\\[1ex]
Gegeben: $(E,\mathcal I)$ Unabhängigkeitssystem, $\Phi:E\rightarrow\mathbb R$, zugehörige Zielfunktion $\varphi$.\\[1ex]
Gesucht: $B^*\in argmin_{B\in\mathcal B}\varphi(B)$
\subsubsection{Bemerkung}\ssslbl
$U=(E,\mathcal I)$ Unabhängigkeitssystem, $(E,\mathcal B)$ zugehöriges Basissystem, $\Phi:E\rightarrow[0,\infty[$, $\varphi$ zugehörige Zielfunktion, $\beta:=\max\bigl\{0,\max_{e\in E}\Phi(e)\bigr\}$. Ferner $\psi:E\rightarrow[0,\infty[$ definiert durch $\psi(e):=\beta-\Phi(e)$ und $\Psi(I)=\sum_{e\in I}\psi(e)$ ($I\in\mathcal I$). Dann gilt
\[\beta r_-(U)-\max_{I\in\mathcal I}\Psi(I)\leq\min_{B\in\mathcal B}\varphi(B)\leq\beta r_+(U)-\max_{I\in\mathcal I}\Psi(I)\]
\subsubsection*{Beweis}
Für $I\in\mathcal I$ gilt $\varphi(I)=\beta\vert I\vert-\Psi(I)$. Wegen $\beta\geq0$ folgt
\[\min_{B\in\mathcal B}\varphi(B)=\min_{B\in\mathcal B}\bigl\{\beta\vert B\vert-\Psi(B)\bigr\}\leq\beta r_+(U)-\max_{B\in\mathcal B}\Psi(B)\]
Analog für $\min_{B\in\mathcal B}\varphi(B)$
\subsubsection{Prozedur: Algorithmus von Kruskal\index{Algorithmus!Kruskal-}}\ssslbl
\begin{lstlisting}
INPUT Zusammenhängender gewichteter Graph $G=(V,E,\Phi)$ mit $\vert E\vert=m$
OUTPUT Spannbaum minimalen Gewichts
BEGIN Sortiere die Kanten nach aufsteigendem Gewicht, dh. $E=\{e_1,\dots,e_m\}$, $\Phi(e_1)\leq\dots\leq\Phi(e_m)$
  $T\leftarrow\emptyset$
  FOR $i=1,\dots,m$ DO
  BEGIN
    IF $T\cup\{e_i\}$ ist kreisfrei THEN
      $T\leftarrow T\cup\{e_i\}$
  END
END
\end{lstlisting}
Variante: Bäume wachsen
\subsubsection{Prozedur: Algorithmus von Prim\index{Algorithmus!Prim-}}
\begin{lstlisting}
INPUT/OUTPUT wie $\text{(\ref{5.2.31})}$
BEGIN Sei $w\in V$, $W\leftarrow\{w\}$, $T\leftarrow\emptyset$
  FOR ALL $v\in N(G,w)$ DO $\mu(v)\leftarrow w$
  WHILE $N(G,W)\neq\emptyset$ DO
    BEGIN Sei $z\in N(G,W)$ mit $\Phi\bigl(\{z,\mu(z)\}\bigr)=\min_{v\in N(G,W)}\Phi\bigl(\{v,\mu(v)\}\bigr)$
      FOR ALL $v\in V\setminus W$ DO
        BEGIN
          IF $v\in N(G,z)\setminus N(G,W)$ THEN
            $\mu(v)\leftarrow z$
          IF $v\in N(G,z)\cap N(G,W)$ UND $\Phi\bigl(\{v,\mu(v)\}\bigr)>\Phi\bigl(\{v,z\}\bigr\}$ THEN
            $\mu(v)\leftarrow z$
        $W\leftarrow W\cup\{z\}$, $T\leftarrow T\cup\bigl\{\{z,\mu(z)\}\bigr\}$
        END
    END
END
\end{lstlisting}
\subsubsection{Beispiel}\ssslbl
\begin{center}
\begin{tikzpicture}
\foreach \n/\pos in {{1/(0,2)}, {2/(2,0)}, {3/(2,4)}, {4/(4,1)}, {5/(4,3)}, {6/(6,0)}, {7/(6,4)}, {8/(7,2)}, {9/(8,0)}, {10/(8,4)}, {11/(10,2)}}
  \node (v\n) [vertexpt,red] at \pos {};

\path[edge,red,very thick] (v1) to (v2) node[midway,below left,black] {2};
\path[edge,red,very thick] (v1) to (v4) node[midway,below,black] {1};
\path[edge,red,very thick] (v1) to (v3) node[midway,above left,black] {1};
\path[edge,red,very thick] (v5) to (v8) node[midway,above,black] {2};
\path[edge,red,very thick] (v6) to (v9) node[midway,below,black] {2};
\path[edge,red,very thick] (v8) to (v9) node[midway,above right,black] {2};
\path[edge,red,very thick] (v7) to (v10) node[midway,above,black] {2};
\path[edge,red,very thick] (v10) to (v11) node[midway,above right,black] {2};
\path[edge,red,very thick] (v8) to (v11) node[midway,above,black] {2};
\path[edge,red,very thick] (v4) to (v8) node[midway,above,black] {1};

\path[edge] (v4) to (v5) node[midway,left] {2};
\path[edge] (v3) to (v5) node[midway,above right] {5};
\path[edge] (v4) to (v6) node[midway,above right] {8};
\path[edge] (v1) to (v5) node[midway,above] {8};
\path[edge] (v2) to (v4) node[midway,below right] {8};
\path[edge] (v2) to (v6) node[midway,below] {9};
\path[edge] (v5) to (v7) node[midway,above left] {5};
\path[edge] (v3) to (v7) node[midway,above] {5};
\path[edge] (v6) to (v8) node[midway,above left] {3};
\path[edge] (v7) to (v8) node[midway,above right] {9};
\path[edge] (v9) to (v11) node[midway,below right] {6};
\end{tikzpicture}\vspace{1em}\\
\emph{minimaler Spannbaum mit Prim}
\end{center}
\subsubsection{Satz}\ssslbl
Algorithmus von Prim ist korrekt.
\subsubsection*{Beweis}
$G=(V,E,\Phi)$ zusammenhängend. Offenbar erzeugt Algorithmus Spannbaum. Induktion nach $\vert W\vert$, um zu zeigen, dass stets erzeugter aktueller Baum $B=(W,T)$ zu minimalen Spannbaum ergänzt wreden kann. Trivial für $W_1=\{v_1\}$. Behauptung gelte für $W_k=\{v_1,\dots,v_k\}$. Seien $T_k=\{e_1,\dots,e_{k-1}\}$, $B_k=(W_k,T_k)$. Algorithmus wählt kürzeste Kante mit genau einem Endpunkt in $W_k$, etwa $e_k=\{v_{i_0},v_{k+1}\}$.\\[1ex]
Seien $W_{k+1}=W_k\cup\{v_{k+1}\}$, $T_{k+1}=T_k\cup\{e_k\}$, $B_{k+1}=(W_{k+1},T_{k+1})$.\\[1ex]
Annahme: Es gibt Spannbaum $S=(V,F)$ mit $B_k\subset B$ und $e_k\not\in F$, der kürzer ist, als alle Spannbäume, die $B_{k+1}$ enthalten. $(V,F\cup\{e_k\})$ besitzt nach \textit{(\ref{5.2.15})} genau einen Kreis $K$. $K$ enthält eine von $e_k$ verschiedene Kante $e\in\delta(G,W_k)$. Nach Konstruktion gilt $\Phi(e)\geq\Phi(e_k)$ (sonst hätte Algorithmus nicht $e_k$ gewählt).\\[1ex]
Mit $F'=\bigl(F\cup\{e_k\}\bigr)\setminus\{e\}$ folgt, dass $S'=(V,F')$ Spannbaum ist mit $\varphi(S')\leq\varphi(S)$ und $B_{k+1}\subset S'$. Widerspruch, es folgt Behaupung.
\subsubsection{Beispiel}\ssslbl
\begin{center}
\begin{tikzpicture}
\foreach \n in {0,1,2,3}
  \node (v\n) [vertexpt] at (90*\n:1cm) {};

\path[edge] (v0) to (v1) node[midway,above right] {2};
\path[edge] (v1) to (v2) node[midway,above left] {$\alpha$};
\path[edge] (v2) to (v3) node[midway,below left] {2};
\path[edge] (v3) to (v0) node[midway,below right] {1};
\end{tikzpicture}
\end{center}
$\alpha\in N$, $\alpha\geq4$. Gesucht minimales (bez. $\Phi$), maximales (bez. Kantenzahl) Matching in $G$.\\[1ex]
Hier: minimales perfektes Matching\\[1ex]
\begin{center}
\begin{tikzpicture}
\foreach \n in {0,1,2,3}
  \node (v\n) [vertexpt] at (90*\n:1cm) {};

\path[edge,orange,very thick] (v1) to (v2) node[midway,above left] {$\alpha$};
\path[edge,orange,very thick] (v3) to (v0) node[midway,below right] {1};
\end{tikzpicture}
\hspace{1cm}
\begin{tikzpicture}
\foreach \n in {0,1,2,3}
  \node (v\n) [vertexpt] at (90*\n:1cm) {};

\path[edge,red,very thick] (v0) to (v1) node[midway,above right] {2};
\path[edge,red,very thick] (v2) to (v3) node[midway,below left] {2};
\end{tikzpicture}\\
\emph{\textcolor{orange}{Greedy-Lösung ($\alpha+1$)}, \textcolor{red}{Optimallösung (4)}}
\end{center}
Fehler hängt von $\alpha$ ab: $\frac{\alpha+1}4\rightarrow\infty$ ($\alpha\rightarrow\infty$)
\subsubsection{Bezeichnung}\ssslbl
Für $j=1,\dots,k$ seien $U_j=(E,\mathcal I_j)$ Unabhängigkeitssysteme auf derselben Grundmenge $E$. Ferner
\[\mathcal I:=\bigcap_{j=1}^k\mathcal I_j\:,\qquad U:=(E,\mathcal I)\]
Dann heißt $U$ \textit{Durchschnitt}\index{Durchschnitt} von $U_1,\dots,U_k$
\subsubsection{Bemerkung}\ssslbl
Durchschnitt von Unabhängigkeitssystemen ist Unabhängigkeitssystem.
\subsubsection*{Beweis}
Sei $I\in\mathcal I$, $J\subset I$.
\begin{align*}
I\in\mathcal I\:&\Rightarrow\:I\in\mathcal I_j&j=1,\dots,k\\
&\Rightarrow\:J\in\mathcal I_j&j=1,\dots,k\\
&\Rightarrow\:J\in\bigcap_{j=1}^k\mathcal I_j=\mathcal I
\end{align*}
\subsubsection{Lemma}\ssslbl
Sei $U=(E,\mathcal I)$ Unabhängigkeitssystem. Dann gibt es $k\in\mathbb N$ und Matroide $M_1,\dots,M_k$ mit
\[U=\bigcap_{j=1}^kM_j\]
\subsubsection*{Beiweis}
Sei $\mathcal K$ Menge der Kreise in $U$, $K\in\mathcal K$, $\mathcal I(K)=\{I\subset E\::\:K\not\subset I\}$. es gilt $\mathcal I\subset\mathcal I(K)$.\\[1ex]
Ferner $\bigl(E,\mathcal I(K)\bigr)$ Unabhängigkeitssystem. Zeige: Matroid.\hfill\textbf{18.10.2008}\\[1ex]
Seien $I,J\in\mathcal I(K)$, $\vert I\vert+1=\vert J\vert$. Nach Definition $K\not\subset I$, $K\not\subset J$.\\[1ex]
Annahme: Für jedes $e\in J\setminus I$ gilt $K\subset I\cup\{e\}$. Dann $\vert K\setminus I\vert=1$, $\vert J\setminus I\vert=1$, also $I\subset J$ und $K\subset J$ Widerspruch zu $J\in\mathcal I(K)$.\\
Sei nun $S\subset E$ mit $S\not\in\mathcal I$ und $K\in\mathcal K$ mit $K\subset S$. Dann $S\not\in\mathcal I(K)$. Also
\[\mathcal I=\bigcap_{K\in\mathcal K}\mathcal I(K)\]
\subsubsection{Definition}\ssslbl
$G=(V,E)$ Graph, $(V_1,\dots,V_k)$ Partition von $V$ und
\[j\in[k]\:\wedge\:e\in E\:\Rightarrow\:\vert e\cap V_j\vert\leq1\]
Dann heißt $G$ \textit{$k$-partit}\index{$k$-partit}.
\subsubsection{Beispiel}\ssslbl
$G=(V,E)$, $(V_1,\dots,V_k)$ Partiton von $V$, $\mathcal I$ Menge aller Matchings in $G$, $U=(E,\mathcal I)$. Nach \textit{(\ref{5.2.38})} ist $U$ Durchschnitt von Matroiden. Tatsächlich ist $U$ Durchschnitt von $k$ \textit{Partitionsmatroiden}\index{Matroid!Partitions-}.\\[1ex]
Sei für $j\in[k]$
\[\Pi_j=\bigl\{\delta(G,v)\::\:v\in V_j\bigr\}\cup\bigl(E\setminus\delta(G,V_j)\bigr)\]
$\Pi_j$ ist Partition von $E$ (Partition von $\delta(G,V)$, Rest)\\
Schranken $\beta_{ji}=1$ für $\delta(G,v)$, Schranke $\vert E\vert$ für $E\setminus\delta(G,V_j)$.\\[1ex]
$M_1,\dots,M_j$ zugehörige Partitionsmatroide; es gilt
\[U=\bigcap_{j=1}^kM_j\]
Insbesondere Matching in bipartiten Graphen entspricht dem Durchschnitt von 2 Matroiden.
\subsubsection{Beispiel}\ssslbl
\begin{center}
\begin{tikzpicture}
\foreach \i/\n/\j in {{0/$\beta_{1,1}=2$/1}, {1/3/2}, {2/1/3}}
  \path[edge,dashed] (-0.5,\i)  node[left,orange] {\n} to (3.5,\i) node[right,orange] {$T_{1,\j}$};
\foreach \i/\n in {{0/1}, {1/2}, {2/2}, {3/1}}
  \path[edge,dashed] (\i,-0.5) to (\i,2.5) node[above,orange] {\n};

\foreach \i/\j in {{2/0}, {2/2}, {2/3}, {1/0}, {0/1}, {0/3}}
    \node[vertexpt] (v\i\j) at (\j,\i) {};
\foreach \i/\j in {{0/0}, {0/2}, {1/1}, {1/2}, {1/3}, {2/1}}
	\node[vertexpt,blue] (v\i\j) at (\j,\i) {};
\node[orange,right] at (5,0.75) {Gegeben};
\node[blue,right] at (5,1.25) {Gesucht};
\end{tikzpicture}
\end{center}
\begin{itemize}
\item Existiert Lösung?
\item Lösung eindeutig?
\item Stabilität
\end{itemize}
Gitterrichtungen $z_1,\dots,z_m\in\mathbb Z^n\setminus\{0\}$ (Messrichtungen, $n=3$)\\[1ex]
$j=1,\dots,m$, $T_{j,1},\dots,T_{j,k_j}$ Gittergeraden parallel zu $z_j$, Träger der Messungen. Dessdaten $\beta_{j,1},\dots,\beta_{j,k_j}$. Sei $K=\mathbb Z^3\cap\bigcap_{j=1}^m\bigcup_{i=1}^{k_j}T_{j,i}$. Setze
\[\mathcal I_j=\bigl\{I\in2^K\::\:\vert I\cap T_{j,1}\vert\leq\beta_{j,1},\dots,\vert I\cap T_{j,k_j}\vert\leq\beta_{j,k_j}\bigr\}\]
$M_j=(K,\mathcal I_j)$, $U:=M_1\cap\dots\cap M_m$\\[1ex]
Rekonstruktionsproblem entspricht einer Maximierung über $U$, Gewichte 1. Es existiert genau dann eine mit den Messdaten kompatible Lösung, wenn es in $U$ eine unabhängige Menge $I^*$ gibt mit
\[\vert I^*\vert=\sum_{i=1}^{k_1}\beta_{1,i}=\dots=\sum_{i=1}^{k_m}\beta_{m,i}\]
\subsubsection{Definition}\ssslbl
\textit{Maximierungsaufgabe über Durchschnitt von $k$ Matroiden}\index{Maximierungsaufgabe!über Durchschnitt} ist spezifiziert durch Matroide $M_1=(E_1,\mathcal I_1),\dots,M_k=(E,\mathcal I_k)$, $\Phi:E\rightarrow[0,\infty[$. Seien $U=(E,\mathcal I):=M_1\cap\dots\cap M_k$, $\varphi:\mathcal I\rightarrow[0,\infty[$ definiert durch $\varphi(I)=\sum_{e\in I}\Phi(e)$. Gesucht $I^*\in argmax_{I\in\mathcal I}\varphi(I)$.\\
(Schwierigkeit: $k=1$: Greedy, $k=2$: effizient möglich (in P), $k\geq3$ schwierig (in NP))
\subsubsection*{Frage}
Wie gut ist Greedy-Algorithmus auf Durchschnitt von $k$ Matroiden?
\subsubsection{Bemerkung}\ssslbl
Seien $k\in\mathbb N$, $M_1,\dots,M_k$ Matroide, $U=(E,\mathcal I)$ ihr Durchschnitt, $I\in\mathcal I$, $e\in E$ mit $I\cup\{e\}\not\in\mathcal I$. Dann enthält $I\cup\{e\}$ höchstens $k$ Kreise.
\subsubsection*{Beweis}
Sei $K\subset I\cup\{e\}$ Kreis in $U$. Dann gibt es $j_0\in\{1,\dots,k\}$, so dass $K$ in $M_{j_0}$ abhängig ist. Nach \textit{(\ref{5.2.15})} enthält $I\cup\{e\}$ genau einen Kreis in $M_{j_0}$. Also kann $I\cup\{e\}$ höchstens $k$ Kreise in $U$ enthalten.
\subsubsection{Lemma}\ssslbl
Durch $(M_1,\dots,M_k,\Phi)$ sei Maximierungsaufgabe über Durchschnitt $U=(E,\mathcal I)$ von $k$ Matroiden spezifiziert. Dann gilt
\[k\rho(U)\geq1\]
\subsubsection*{Beweis}
Seien $A^*\subset E$, $I,J$ Basen in $U_{A^*}$ mit $r_-(U_{A^*})=\vert I\vert$, $r_+(U_{A^*})=\vert J\vert$, $r_-(U_{A^*})=\rho(U)r_+(U_{A^+})$.\\[1ex]
oBdA $\vert I\vert\geq1$. Seien $s\in\mathbb N$ und $I\setminus J=\{e_1,\dots,e_s\}$. nach \textit{(\ref{5.2.43})} enthält $J\cup\{e_1\}$ höchstens $k$ Kreise. Da $I$ unabhängig ist, schneidet jeder solche Kreise $J\setminus I$. Es gibt $A_1\subset J\setminus I$ mit $\vert A_1\vert\leq k$, $(J\setminus A_1)\cup\{e_1\}\in\mathcal I$. Sei $J_1:=(J\setminus A_1)\cup\{e_1\}$. Dann $I\setminus J_1=\{e_2,\dots,e_k\}$.\\[1ex]
Fahre suksessive fort: nach $s$ Schritten erhalten wir $A\subset J\setminus I$ mit $\vert A\vert\leq ks$, $(J\setminus A)\cup\{e_1,\dots,e_s\}\in\mathcal I$. Es folgt:
\[I=(I\cap J)\cup(I\setminus J)\subset(J\setminus A)\cup(I\setminus J)\in\mathcal I\]
Da $I$ Basis: $I=(J\setminus A)\cup(I\setminus J)$.\\[1ex]
Daher $J\setminus I=J\setminus\bigl((J\setminus A)\cup(I\setminus J)\bigr)=A\cap J=A$, also $\vert J\setminus I\vert\leq ks=k\cdot\vert I\setminus J\vert$. Es folgt
\[\vert J\vert=\vert J\cap I\vert+\vert J\setminus I\vert\leq\vert I\cap J\vert+k\vert I\setminus J\vert\leq k\vert I\vert\]
Somit $\vert I\vert\leq\rho(U)\vert J\vert\leq k\rho(U)\vert I\vert$ und damit die Behauptung.
\subsubsection{Satz}\ssslbl
Gegeben Maximierungsaufgabe $(M_1,\dots,M_k;\Phi)$ über Durchschnitt von $k$ Matroiden, $\varphi$ zugehörigen Zielfunktion. Dann
\[\varphi(I^*)\leq k\varphi(I^g)\]
\subsubsection*{Beweis}
\textit{(\ref{5.2.44})}, \textit{(\ref{5.2.23})}
\section{Algorithmen und Komplexität}\slbl
\subsubsection*{Fragen}
\begin{itemize}
\item Laufzeit von Algorithmen, Güte
\item mathematisches Konzept?
\item elementare Operationen ($+,-,\cdot,\%,\leq,=,\geq,\leftarrow$)
\item Größe der beteiligten Zahlen
\end{itemize}
\subsection{Algorithmische Berechnungen: Erste effiziente Methoden}\sslbl
\begin{itemize}
\item Was ist ein effiziente Algorithmus? $\sim$ elementaren Operationen, Bitgröße, asymptotisch\hfill\textbf{21.11.2008}
\item Wann ist das Problem leicht? Es existiert effizienter Algorithmus, Äquivalenzklassen gleich schwieriger Probleme
\item Was ist ein Problem? (Relation (Input, Output))
\end{itemize}
\subsubsection{Bezeichnung}\ssslbl
Addition ($+$), Subtraktion ($-$), Multiplikation ($\cdot$), Division ($\%$) (ggf. mit Rest) heißen \textit{elementare arithmetische Operationen}\index{Operation!elementare arithmetische},\\[1ex]
Vergleiche ($\leq$, $\geq$, $=$, $\neq$) \textit{elementare Vergleichsoperationen}\index{Operation!elementare Vergleichs-},\\[1ex]
Zuweisungen ($\leftarrow$) von Werten an Variable.\\[1ex]
elementare arithmetische / Vergleichsoperationen bzw. Zuweisungen: \textit{elementare Operationen}\index{Operation!elementare}\\[1ex]
Befehle $\leftarrow$, \texttt{WHILE DO END}, \texttt{HALT} heißen \textit{elementare Programmbefehle}\index{Programmbefehl!elementar}
\subsubsection{Definition (informell)}\ssslbl 
\textit{Algorithmus}\index{Algorithmus} $\mathcal A$ besteht aus Folge (zu Beginn mit 0 initialisierten) Variablen und \textit{endlichen Sequenz}\index{Sequenz!endliche} elementarer Programmbefehle. Diese machen: Zuwesung von Symbolen des Inputs an Variable, elementare arithmetische Berechnungen, dh. Zuweisung von Ergebnissen arithmetischer Operationen zwischen Variablen an Variable, Zuweisung von Variablenwerten an Output.\\[1ex]
Algorithmus $\mathcal A$ löst Program $\Pi$, wenn $\mathcal A$ für jeden Input noch nach endlich vielen elementaren Operationen einen zugehörigen korrekten Output $\mathcal O$ bestimmt oder entscheidet, dass kein solcher existiert.
\subsubsection*{Frage}
Auf welchen Zahlen / Symbolen sollen Rechnungen erlaubt sein? Hier (fast immer) rationale Zahlen
\subsubsection{Bezeichnung}\ssslbl
Jede endliche Sequenz $\mathcal I:=(\sigma,\sigma_r,\dots,\sigma_1)$ mit $\sigma\in\{+,-\}$, $r\in\mathbb N_0$, $\sigma_1,\dots,\sigma_r\in\{0,1\}$ heißt \textit{(Binär-)String}\index{String!Binär-} [($+$), ($-$) Strings identifizieren mit Zahl 0]
\[\eta:=\sigma\sum_{i=0}^{r-1}\sigma_{i+1}2^i\:\rightarrow\:(\sigma,\sigma_r,\dots,\sigma_1)\]
Darstellung ganzer Zahlen
\subsubsection{Definition}\ssslbl
Sei $\eta\in\mathbb Z$. Dann heißt $\size(\eta):=1+\left\lceil\log(\vert\eta+1)\right\rceil$ \textit{Kodierungslänge}\index{Kodierungslänge!in $\mathbb N$}. Seien $\rho\in\mathbb Q$, $\eta\in Z$, $\mu\in\mathbb N$, $\rho=\frac{\eta}{\mu}$. Dann heißt $(\eta,\mu)$ eine \textit{(ganzzahlige) Darstellung}\index{Darstellung!ganzzahlige} von $\rho$\\[1ex]
Sind $\eta$, $\mu$ teilerfremd, so heißt $(\eta,\mu)$ \textit{teilerfremde Darstellung}\index{Darstellung!teilerfremde}. $\size(\eta)+\size(\mu)$ \textit{Kodierungslänge}\index{Kodierungslänge! in $\mathbb Q$} der durch $(\eta,\mu)$ gegebenen rationalen zahl $\rho$, Abkürzung oft $\size(\rho)$ (bei klar gegebener Darstellung $(\eta,\mu)$\\[1ex]
Seien $m,n\in\mathbb N$, $A=(\alpha_{ij})_{\substack{i=1,\dots,m\\j=1,\dots,n}}\in\mathbb Q^{m\times n}$. Dann
\[\size(A):=\sum_{i=1}^m\sum_{j=1}^n\size(\alpha_{ij})\]
\textit{Kodierungslänge}\index{Kodierungslänge!für Matrizen} von $A$\\[1ex]
Sei Input einer Aufgabe durch $(\rho_1,\dots,\rho_k)$ spezifiziert mit $\rho_i\in\mathbb Q$. Dann
\[\size(\mathcal I):=\sum_{i=1}^k\size(\rho_i)\]
\textit{(binäre) Inputgröße}\index{Inputgröße!binäre}
\subsubsection{Bemerkung}\ssslbl
Sei $\mathcal I:=(m,n,A,b,c)$ spezifizierte lineare Optimierungsaufgabe mit rationalem Input. Dann
\[\size(\mathcal I)=\size(m)+\size(n)+\size(A)+\size(b)+\size(c)\geq(m+1)(n+1)+1\]
\subsubsection*{Beweis}
Zur Kodierung von $m,n,A,b,c$ werden $2+m\cdot n+n+m$ Trenn- bzw. Vorzeichenbits benötigt.
\subsubsection{Lemma}\ssslbl
\begin{enumerate}[(a)]
\item Sei $\mu\in\mathbb Z$. Dann 
\[1+\log\bigl(\vert\mu\vert+1\bigr)\leq\size(\mu)\leq2+\log\bigl(\vert\mu\vert+1\bigr)\]
\item Seien $\alpha,\beta\in\mathbb Z$. Dann
\[\size(\alpha+\beta)\leq\size(\alpha)+\size(\beta)\]
\item Seien $\rho_1,\rho_2\in\mathbb Q$ (mit geg. Darstellung), dann:
\[\size(\rho_1\cdot\rho_2)\leq\size(\rho_1)+\size(\rho_2)\]
\item Seien $\rho\in\mathbb Q$, $A\in\mathbb Q^{m\times n}$. Dann
\[\size(\rho\cdot A)\leq m\cdot n\cdot\size(\rho)+\size(A)\]
\end{enumerate}
\subsubsection*{Beweis}
\begin{enumerate}[(a)]
\item $\checkmark$
\item
\begin{align*}
\size(\alpha+\beta)&=1+\left\lceil\log\bigl(\vert\alpha+\beta\vert+1\bigr)\right\rceil\\
&\leq1+\left\lceil\log\bigl(\vert\alpha\vert+\vert\beta\vert+1\bigr)\right\rceil\\
&\leq1+\left\lceil\log\bigl(\vert\alpha\vert+1\bigr)\bigl(\vert\beta\vert+1\bigr)\right\rceil\\
&\leq\size(\alpha)+\size(\beta)
\end{align*}
\item Seien zunächst $\alpha,\beta\in\mathbb Z$. Dann
\begin{align*}
\size(\alpha\beta)&=1+\left\lceil\log\bigl(\vert\alpha\beta\vert+1\bigr)\right\rceil\\
&\leq1+\left\lceil\log\bigl(\vert\alpha\vert+1\bigr)\bigl(\vert\beta\vert+1\bigr)\right\rceil\\
&\leq\size(\alpha)+\size(\beta)
\end{align*}
$\eta_i\in\mathbb Z$, $\mu_i\in\mathbb N$ ($i=1,2$), $\rho_i=\frac{\eta_i}{\mu_i}$. Dann
\[\size(\rho_1\cdot\rho_2)=\size(\eta_1\cdot\eta_2)+\size(\mu_1\cdot\mu_2)\leq\dots=\size(\rho_1)+\size(\rho_2)\]
\item
\[\size(\rho A)=\sum_{i=1}^m\sum_{j=1}^n\size(\rho\cdot\alpha_{ij})\leq\sum_{i=1}^m\sum_{j=1}^n\bigl(\size(\rho)+\size(\alpha_{ij})\bigr)=m\cdot n\cdot\size(\rho)+\size(A)\]
\end{enumerate}
\subsubsection{Definition}\ssslbl
Seien $\Pi$ Problem, $\mathcal A$ Algorithmus von $\Pi$. Existiert Polynom $\pi:\mathbb N_0\rightarrow\mathbb N_0$, so dass für jeden Input das Produkt aus Anzahl elementarer Operationen von $\mathcal A$ bei Anwendung auf $\mathcal I$ und dem Maximum der Größen der beteiligten Zahlen durch $\pi\bigl(\size(\mathcal I)\bigr)$ nach oben beschränkt ist, so heißt $\mathcal A$ \textit{polynomiell}\index{Algorithmus!polynomieller}\index{polynomiell}.\\[1ex]
Im folgenden: polynomiell $\approx$ effizient\\[1ex]
Vorsicht: $\size(\mathcal I)n$, $n^{1.000.000.000}$ polynomiell, $n^{\log(\log(\log n)))}$ nicht polynomiell. Also polynomiell \textit{mathematisches Konstrukt}, nicht identisch mit praktikabel, meistens aber doch!
\subsubsection{Bemerkung}\ssslbl
Seien $\mathcal A,\mathcal B$ Algorithmen. Ist $\mathcal B$ polynomiell und benötigt $\mathcal A$ polynomiell viele elementare Operationen und zusätzlich polynomiell viele Aufrufe von $\mathcal B$ als Subroutine, so ist $\mathcal A$ polynomiell.
\subsubsection*{Beweis}
Polynome unter Komposition abgeschlossen
\subsubsection{Prozedur: Euklidischer Algorithmus\index{Algorithmus!Euklidischer}}
\begin{lstlisting}
INPUT $\mu,\nu\in\mathbb N$
OUTPUT $\ggT(\mu,\nu)$
BEGIN WHILE $\mu\geq1$ AND $\nu\geq1$ DO
  BEGIN
    IF $\mu\geq\nu$ THEN
      $\mu\leftarrow\mu-\Bigl\lfloor\frac{\mu}{\nu}\Bigr\rfloor\nu$
    ELSE
      $\nu\leftarrow\nu-\Bigl\lfloor\frac{\nu}{\mu}\Bigr\rfloor\mu$
  END
  $\ggT(\mu,\nu)\leftarrow\max\{\nu,\mu\}$
END
\end{lstlisting}
\subsubsection{Lemma}\ssslbl
Seien $\mu,\nu\in\mathbb N$. Dann findet der euklidische Algorithmus den $\ggT(\mu,\nu)$ in polynomieller Zeit. Genauer: höchstens $\left\lfloor\log(\mu\cdot\nu)\right\rfloor+1$ Iterationen, konstant viele Operationen pro Iteration auf Zahlen der Größe $O\left(\max\bigl\{\log\mu,\log\nu\bigr\}\right)$
\subsubsection*{Beweis}
Übung
\subsubsection{Korollar}\ssslbl
Aus gegebener Darstellung $(\eta,\mu)$ einer rationalen Zahl $\rho$ kann ihre teilerfremde Darstelleung in polynomieller Zeit berechnet werden.
\subsubsection*{Beweis}
$\nu:=\vert\eta\vert$, $\kappa:=\ggT(\mu,\nu)$. Dann $\left(\frac{\eta}2,\frac{\mu}2\right)$ teilerfremde Darstellung, \textit{(\ref{6.1.10})}: $\kappa$ in polynomieller Zeit berechenbar. Dann nach 2 Divisionen.\\[2ex]
Jetzt: Lösen linearer Gleichungssysteme in polynomieller Zeit\\[1ex]
Gauß-Elimination polynomiell viele Schritte, Frage: Bleiben Zwischenergebnisse klein, dh. ihre binäre Größe polynomiell in $\size(A)+\size(b)$ beschränkt.\hfill{25.11.2008}\\[1ex]
$Ax=b$, $A\in\mathbb Q^{n\times n}$, $\rang(A)=n$, $x^*=A^{-1}b$, $A=(a_1,\dots,a_n)$\\
Cramersche Regel:
\[\xi_i^*=\frac{\det(a_1,\dots,a_{i-1},b,a_{i+1,},\dots,a_n)}{\det(A)}\]
\subsubsection{Lemma}\ssslbl
Sei $A\in\mathbb Q^{n\times n}$. Dann gibt es Darstellung von $\det(A)$ mit
\[\size\bigl(\det(A)\bigr)\leq2\size(A)\]
\subsubsection*{Beweis}
Sei $(\eta,\mu)$ teilerfremde Darstellung von $\det(A)$. Für $i,j=1,\dots,n$ seien $\eta_{i,j}\in\mathbb Z$, $\mu_{i,j}\in\mathbb N$, $\alpha_{i,j}=\frac{\eta_{i,j}}{\mu_{i,j}}$, $A=(\alpha_{i,j})_{i,j\in[n]}$.\\
Es gilt: $\mu\leq\prod_{i,j=1}^n\mu_{i,j}$
\begin{align*}
\left\vert\det A\right\vert&=\left\vert\sum_{\sigma\in S_n}\sgn(\sigma)\prod_{i=1}^n\alpha_{i,\sigma(i)}\right\vert&S_n\text{ Permutationen}\\
&\leq\sum_{\sigma\in S_n}\prod_{i=1}^n\left\vert\alpha_{i,\sigma(i)}\right\vert\\
&\leq\prod_{i,j=1}^n\bigl(\vert\eta_{i,j}\vert+1\bigr)
\end{align*}
Also
\[\vert\eta\vert=\mu\bigl\vert\det(A)\bigr\vert\leq\prod_{i,j=1}^n\Bigl(\bigl(\vert\eta_{i,j}\vert+1\bigr)\mu_{i,j}\Bigr)\]
Es folgt:
\begin{align*}
\size\bigl(\det(A)\bigr)&=\size(\eta)+\size(\mu)\\
&\leq\sum_{i,j=1}^n\size\bigl(\vert\eta_{i,j}\vert+1\bigr)+2\sum_{i,j=1}^n\size(\mu_{i,j})\\
&\leq2\size(A)
\end{align*}
Ist Gauß-Elimination polynomiell? Vollständige Gauß-Elimination:
\[A\rightarrow\left(\begin{array}{cc}D&C\\0&0\end{array}\right)\]
$D$ Diagonalmatrix, voller Rang.
\[\underset{\rightarrow\text{Lösen eines GL-Systems}}{A=(A',b)}\:,\qquad\underset{\text{Inverse berechnen}}{A=(A',E_m)}\]
\subsubsection{Satz}\ssslbl
Angewandt auf
\[A=\left(\alpha_{i,j}\right)_{\substack{i\in[m]\\j\in[n]}}\in\mathbb Z^{m\times n}\]
benötigt Gauß-Elimination $O(m^2n)$ elementare Operationen. Die teilerfremden Darstellungen der auftretenden rationalen Zahlen haben Kodierungslänge $O\bigl(\size(A)\bigr)$.
\subsubsection*{Beweis}
Nach höchstens $m-1$ Schritten ist Matrix $\left(\begin{array}{cc}B'&C\\0&0\end{array}\right)$ erreicht, wobei $B'$ eine $\rang(A)\times\rang(A)$ obere Dreiecksmatrix ist. Nach weiteren höchstens $m-1$ Schritten erhalten wir gesuchte Gestalt.\\[1ex]
Pro Schritt ggf 2 Permutationen. Aktualisierung (Nummerierung angepasst):
\[\alpha_{i,j}\leftarrow\alpha_{i,j}\frac{\alpha_{i,j}\alpha_{k,j}}{\alpha_{k,k}}\]
Insgesamt $O(m^2n)$ Operationen.\\[1ex]
Abschätzung binäre Größe der Koeffizienten (Vorwärtselimination, Rückwärtseliminiation analog)\\[1ex]
Sei $A_k$ Matrix nach $k$-tem Vorwärtsschritt
\[A_k=\left(\begin{array}{cc}B_k&C_k\\0&M_k\end{array}\right)\]
mit
\[B_k\in\mathbb Q^{k\times k}\:,\qquad C_k=\left(\gamma_{i,j}^{(k)}\right)_{\substack{i=1,\dots,k\\j=k+1,\dots,n}}\in\mathbb Q^{k\times(n-k)}\:,\qquad M_k\left(\mu_{i,j}^{(k)}\right)_{\substack{i=k+1,\dots,m\\j=k+1,\dots,n}}\in\mathbb Q^{(m-k)\times(n-k)}\]
Seien $i_0\in\{k+1,\dots,m\}$, $j_0\in\{k+1,\dots,n\}$, $c_k\left(\gamma_{1,j_0},\dots,\gamma_{k,j_0}\right)^T$\\[1ex]
Es gilt
\[\mu_{i_0,j_0}^{(k)}=\frac{\det\left(\begin{array}{cc}B_k&C_k\\0&\mu_{i_0,j_0}^{(k)}\end{array}\right)}{\det B_k}\]
Da Determinante unter elementaren Zeilenoperationen invariant bleiben, gilt
\[\mu_{i_0,j_0}^{(k)}=\frac{\det(\alpha_{i,j})_{\substack{i\in[k]\cup\{i_0\}\\j\in[k]\cup\{j_0\}}}}{\det(\alpha_{i,j})_{i,j\in[k]}}\]
Nach \textit{(\ref{6.1.12})} folgt für teilerfremde Darstellungen:
\[\size\left(\mu_{i_0,j_0}^{(k)}\right)\leq4\size(A)\]
\subsubsection{Korollar}\ssslbl
Die folgenden Probleme lassen sich in polynomieller Zeit lösen:
\begin{enumerate}[(a)]
\item Gegeben: $A=(\alpha_{i,j})_{\substack{i\in[m]\\j\in[n]}}\in\mathbb Q^{m\times n}$, $b\in\mathbb Q^m$; finde eine Lösung $x^*$ von $Ax=b$ oder entscheide, dass die Gleichung unlösbar ist.
\item Gegeben: $A\in\mathbb Q^{m\times n}$, bestimme $\rang(A)$
\item Gegeben: $v_1,\dots,v_k\in\mathbb Q^n$, entscheide, ob $v_1,\dots,v_k$ linerar unabhängig sind.
\item Gegeben: $A\in\mathbb Q^{m\times n}$, bestimme Basis von $Ax=0$.
\item Gegeben: $A\in\mathbb Q^{m\times n}$, bestimme $\det(A)$.
\item Gegeben: $A\in\mathbb Q^{n\times n}$, bestimme $A^{-1}$ oder entscheide, dass $A$ singulär ist.
\end{enumerate}
\subsubsection*{Beweis}
$\checkmark$
\subsubsection{Bemerkung}\ssslbl
Sei $p$ Primzahl. der Gauß-Algorithmus über $\mathbb Z_p$ läuft in polynomieller Zeit.
\subsubsection*{Beweis}
Abschätzung elementarer Operationen analog. Kodierungslängen konstant (Repräsentantensystemen $\{0,\dots,p-1\}$)\\[1ex]
Korollar gilt analog.
\subsubsection{Satz}\ssslbl
Am Ende der Breitensuche mit Markierungsregel $\mu(v)\leftarrow\mu(u)+1$ angewendet auf (Di-)Graphen $G=(V,e)$ mit Startknoten $s$ gibt die Markierung $\mu(v)$ für jeden Knoten $v\in V$ die Länge eines $s-v$-Weges minimaler Kantenzahl in $G$ an (wobei $\mu(v)=\infty$ bedeutet, dass kein $s-v$-Weg existiert).
\subsubsection{Bezeichnung}\ssslbl
Das Problem:\\[1ex]
Gegeben: $n\in\mathbb N$, $a\in\mathbb N^n$, $\beta\in\mathbb N$, bestimme $x\in\mathbb N_0^n$ mit $a^Tx=\beta$ oder entscheide, dass es kein solches gibt\\[1ex]
heißt \textit{Intervallpflasterung}\index{Intervallpflasterung} (auch \textit{integer knapsack})
\[\left[\begin{aligned}a^Tx&=\beta\\x&\geq0\\x&\in\mathbb Z^n\end{aligned}\right]\quad\left[\begin{aligned}a=\left(\begin{array}{c}\alpha_1\\\vdots\\\alpha_n\end{array}\right)\:,\:a^Tx=\sum_{i=1}^n\alpha_i\xi_i=\beta\:,\:\xi_i\in\mathbb N_0\end{aligned}\right]\]
\subsubsection{Beispiel}\ssslbl
$n=3$, $a=(3,5,7)^T$, $\beta=10$, Lösung: $x_1=\left(\begin{array}{c}0\\2\\0\end{array}\right)$, $x_2=\left(\begin{array}{c}1\\0\\1\end{array}\right)$.\\[1ex]
Konstruiere Digraph $V:=\{0,1,\dots,10\}$, $E=\{(0,3),(1,4),\dots,(2,9),(3,10)\}$\\
\begin{center}
\begin{tikzpicture}
\foreach \i in {0,...,10}
  \node[vertex] (v\i) at (\i,0) {\i};
\foreach \i in {1,...,6} {
  \pgfmathparse{\i+3}
  \pgfmathdectobase{\pgfmathresult}{\pgfmathresult}{16}
  \pgfmathbasetodec{\pgfmathresult}{\pgfmathresult}{16}
  \path[arrow,bend left] (v\i) to (v\pgfmathresult);
}
\foreach \i in {1,...,4} {
  \pgfmathparse{\i+5}
  \pgfmathdectobase{\pgfmathresult}{\pgfmathresult}{16}
  \pgfmathbasetodec{\pgfmathresult}{\pgfmathresult}{16}
  \path[arrow,bend right] (v\i) to (v\pgfmathresult);
}
\foreach \i in {1,...,2} {
  \pgfmathparse{\i+7}
  \pgfmathdectobase{\pgfmathresult}{\pgfmathresult}{16}
  \pgfmathbasetodec{\pgfmathresult}{\pgfmathresult}{16}
  \path[arrow,bend right=45] (v\i) to (v\pgfmathresult);
}

\path[arrow,bend right,very thick,orange] (v0) to (v5);
\path[arrow,bend right,very thick,orange] (v5) to (v10);

\path[arrow,bend left, very thick,red] (v0) to (v3);
\path[arrow,bend right=45,very thick,red] (v3) to (v10);

\path[arrow,bend right=45,very thick, blue] (v0) to (v7);
\path[arrow,bend left,very thick, blue] (v7) to (v10);
\end{tikzpicture}\\
\emph{Lösung für 0-10-Weg: \textcolor{orange}{$x_1$}, \textcolor{red}{$x_2$}, \textcolor{blue}{$x_2$}}
\end{center}
\subsubsection{Satz}\ssslbl
Es gibt einen Algorithmus für Intervallpflasterung, dessen Laufzeit linear in der Inputgröße und in $\beta$ ist.\\[1ex]
Problem: $\beta\sim2^{\size(\beta)}$ Laufzeit exponentiell in $\size(\mathcal I)$.\hfill\textbf{28.11.2008}
\subsubsection*{Beweis}
$\mathcal I=(n,a,\beta)$ Aufgabe von Intervallpflasterung., $a=(\alpha_1,\dots,\alpha_n)^T$. Definiere $G=(V,E)$ durch $V=\{0,\dots\beta\}$, $E=\bigl\{(i,j)\::\:i,j\in V\:,\:j-i\in\{\alpha_1,\dots,\alpha_n\}\bigr\}$\\[1ex]
Für $e=(i,j)\in E$ sei $\lambda(e)=j-i$, $\Lambda_i:=\bigl\{e\in E\::\:\lambda(e)=\alpha_i\bigr\}$\\[1ex]
Weg $W=(e_1,\dots,e_p)$ mit Anfangsknoten 0 ist genau dann $0-\beta$-Weg, wenn
\[\sum_{i=1}^\lambda(e_i)=\beta\]
Setze
\[\xi_i=\bigl\vert\{e_1,\dots,e_p\}\cap\Lambda_i\}\bigr\vert\qquad(i\in[n]\]
$x_W=(\xi_1,\dots,x_n)^T$. Dann $x_W$ ist Lösung. Umkehrung gilt ebenfalls. Intervallpflasterung wird zurückgeführt auf Finden eines $0-\beta$-Weges in $G$. Benutze Breitensuche.\\[1ex]
Algorithmus: $O\bigl(\size(\mathcal I)2^{\size(\mathcal I)}\bigr)$ nicht polynomiell
\subsubsection{Definition}\ssslbl
Sei $\mathcal A$ Algorithmus, der $\mathcal I=(p,\rho_1,\dots,\rho_p)$ als Input akzeptiert mit $p\in\mathbb N$, $\rho_1,\dots,\rho_n\in\mathbb Z$. Sei $\kappa(\mathcal I)=\max\bigl\{\vert\rho_1\vert,\dots\vert\rho_n\vert\bigr\}$. Existiert Polynom $\pi:\mathbb N\times\mathbb N\rightarrow\mathbb N$, so dass $\pi\bigl(\size(\mathcal I),\kappa(\mathcal I)\bigr)$ eine obere Schranke für Produkt der Anzahl der elementaren Operationen die $\mathcal A$ für Input $\mathcal I$ durchführt, und der Größe der beteiligten Zahlen ist, so heißt $\mathcal A$ \textit{pseudopolynomiell}\index{polynomiell!pseudo-}
\subsubsection{Korollar}\ssslbl
Intervallpflasterung ist in pseudopolynomieller Zeit lösbar.
\subsubsection*{Frage}
Gibt es polynomiellen Algorithmus für Intervallpflasterung?\\[1ex]
bis heute unbekannt (P+NP). Ausweg: Vergleich mit anderen Problemen modulo polynomieller Oerpationen.
\subsubsection{Definition}\ssslbl
Seien $\Pi_1$, $\Pi_2$ Probleme. Eine Funktion $\omega$, die jeder Aufgabe $\mathcal I$ von $\Pi_2$ eine Lösung $\mathcal O$ zuordnet, heißt \textit{Orakel}\index{Orakel} für $\Pi_2$, wenn es Polyom $\pi:\mathbb N_0\rightarrow\mathbb N_0$ gibt, so dass
\[\size(\mathcal O)\leq\pi\bigl(\size(\mathcal I)\bigr)\]
gilt.\\[1ex]
Man sagt, dass Algorithmus $\mathcal A$ für $\Pi_1$ ein \textit{Orakel} $\omega$ für $\Pi_2$ \textit{aufruft}\index{Orakel!aufrufen}, wenn $\mathcal A$ einen Input $\mathcal I$ von $\Pi_2$ berechnet und ihm dann das Ergebnis $\omega(\mathcal I)$ zur Verfügung stellt.\\[1ex]
$\Pi_1$ heißt \textit{polynomiell reduzierbar}\index{polynomiell!reduzierbar}\index{reduzierbar!polynomiell} auf $\Pi_2$, wenn es Algorithmus $\mathcal A$ gibt, der mittels polynomiell vieler elementarer Operationen und Aufrufen eines Orakels $\omega$ für $\Pi_2$ auf Zahlen polynomieller Größe löst, $\mathcal A$ heißt dann \textit{polynomielle Reduktion}\index{Reduktion!polynomielle} von $\Pi_1$ auf $\Pi_2$.\\[1ex]
$\Pi_1$, $\Pi_2$ heißen \textit{polynomiell äquivalent}\index{äquivalent!polynomiell}, wenn $\Pi_1$ polynomiell auf $\Pi_2$ und $\Pi_2$ polynomiell auf $\Pi_1$ reduzierbar ist.
\subsubsection{Satz}\ssslbl
Die folgenden Klassen linearer Optimierungsprobleme auf rationalen Inputs lassen sich polynomiell aufeinander reduzieren:
\begin{center}
allgemeines LP, LP in Standardform, LP in kanonischer Form, LP in natürlicher Form
\end{center}
\subsubsection*{Ansatz}
Problem schwierig, wenn sich viele andere polynomiell darauf reduzieren lassen. Jetzt präzisiere viele: Entscheidungsproblem
\subsubsection{Bezeichnung}\ssslbl
Das Problem
\begin{center}
Gegeben Graph $G$; ist $G$ hamiltonsch
\end{center}
wird als \textit{Hamiltonkreis}\index{Hamiltonkreis} bezeichnet.
Output: ja / nein
\subsubsection{Bezeichnung (informell)}\ssslbl
Sei $\Pi$ Problem, dess Output nur aus \textit{ja} oder \textit{nein} (bzw 1,0) besteht. Dann heißt $\Pi$ \textit{Entscheidungsproblem}\index{Entscheidungsproblem}.
\subsubsection*{Frage}
Wie allgemein sind Entscheidungsprobleme?
\subsubsection{Bemerkung}\ssslbl
Das Problem
\begin{center}
Gegeben Graph $G$; bestimme Hamiltonkreis oder entscheide dass keiner existiert
\end{center}
ist polynomiell reduzierbar auf Hamiltonkreis.
\subsubsection*{Beweis}
Sei $\mathcal A$ Algorithmus für Hamiltonkreis. Sei $G=(V,E)$, $E=\{e_1,\dots,e_m\}$. Rufe $\mathcal A$ für $G$ auf.\\[1ex]
Antwort \textit{nein}: fertig\\[1ex]
Sei Antwort \textit{ja}. Wende $\mathcal A$ auf $(V,E\setminus\{e_m\})$. Antwort \textit{nein}: Jeder Hamiltonkreis enthält $e_m$. Setze $E_m=E$. Antwort \textit{ja}: setze $E_m=E\setminus\{e_m\}$\\
Fahre sukzessive fort: $H:=(V,E_1)$ ist gesuchter Hamiltonkreis. $\mathcal A$ wurde höchstens $m+1$ mal aufgerufen.\\[2ex]
Geht das auch für Entscheidungsversion von Intervallpflasterung?
\begin{center}
Gegeben $n\in\mathbb N$, $\alpha_1,\dots,\alpha_n\in\mathbb N$, $\beta\in\mathbb N$, existiert $\xi_1,\dots,\xi_n\in\mathbb N_0$ mit $\sum_{i=1}^n\alpha_i\xi_i=\beta$
\end{center}
Idee: Wende $\mathcal A$ für Entscheidungsproblem auf reduzierte Instanzen $(n,\alpha_1,\dots,\alpha_n,\beta-\eta\cdot\alpha_n)$ ($\eta\in\mathbb N$) an. Problem: Anzahl Aufrufe für $i$ ist $\left\lfloor\frac{\beta}{\alpha_i}\right\rfloor$, dh. neuer Ansatz nicht polynomiell.
\subsubsection{Bezeichnung}\ssslbl
Seien $\eta^*\in\mathbb Z$ und $\mathcal O_{\leq}$ (bzw $\mathcal I_{\geq}$ analog) ein Algorithmus mit Output in $\{ja,\:nein\}$, der als Input ganze Zahlen $\tau$ akzeptiert und der genau \textit{ja} ausgibt, wenn $\tau\leq\eta^*$ ist. Dann heißt $\mathcal I_{\leq}$ Orakel für $\eta^*$. Schreibweise:
\[\mathcal O_{\leq}=ja\text{ bzw }nein\]
Bsp Intervallpflasterung: $\eta^*=\max\bigl\{\eta\::\:\text{reduzierte Aufgabe lösbar}\bigr\}$
\subsubsection{Prozedur: Binäre Suche\index{Suche!Binäre}}\ssslbl
\begin{lstlisting}
INPUT $\mu,\nu\in\mathbb Z$, $\mu<\nu$, Orakel $\mathcal O_{\leq}$ für ein $\eta^*\in\mathbb Z$ mit $\mu\leq\eta^*\leq\nu$
OUTPUT $\eta^*$
BEGIN WHILE $\mu<\nu$ DO
  $\tau\leftarrow\left\lfloor\frac{\mu+\nu}2\right\rfloor$
  IF $\mathcal O_{\leq}(\tau)=ja$ THEN
    $\nu\leftarrow\tau$
  ELSE
    $\mu\leftarrow\tau+1$
END
$\eta^*\leftarrow\mu$
\end{lstlisting}
\subsubsection{Lemma}\ssslbl
Laufzeit der binären Suche $O\bigl(\log(\nu-\mu)\bigr)$
\subsubsection*{Beweis}
Übung
\subsubsection{Korollar}\ssslbl
Sei $\Pi$ ein Evaluationsproblem\index{Evaluationsproblem} (gesucht Optimum der Ziefunktion) mit Eigenschaft, dass stets Unzulässigkeit vorliegt oder Optimum ganzzahlig ist, bekannt jeweils obere / untere Schranke mit Kodierungslänge polynomiell in $\size(\mathcal I)$. Sei $\Gamma$ zugehöriges Entscheideungsproblem. Besitzt $\Gamma$ einen polynomiellen Algorithmus, so auch $\Pi$.
\subsubsection*{Beweis}
folgt aus \textit{(\ref{6.1.29})}.\hfill\textbf{02.12.2008}
\subsubsection{Definition}\ssslbl
Die Klasse $NP$  besteht aus allen Entscheidungsproblemen $\Pi$ mit folgenden Eigenschaften: Es gibt Polynom $\pi$ und polynomiellen Algorithmus $\mathcal A$, der als Input Paare $(\mathcal I,\mathcal Z)$ akzeptiert, bestehend aus Aufgabe $\mathcal I$ von $\Pi$ und einer Sequenz $\mathcal Z$ rationaler Zahlen mit
\[\size(\mathcal Z)\leq\pi\bigl(\size(\mathcal I)\bigr)\]
$\mathcal Z$ \textit{Zertifikat}\index{Zertifikat} und einen Wert $\pi(\mathcal I,\mathcal Z)$ berechnet, so dass gilt:
\begin{enumerate}[(a)]
\item Ist $\mathcal I$ eine Nein-Instanz von $\Pi$, so gilt $\tau(\mathcal I,\mathcal Z)=0$ für alle solchen Zertifikate
\item Ist $\mathcal I$ Ja-Instanz von $\Pi$, so existiert ein Zertifikat $\mathcal Z$ mit $\tau(\mathcal I,\mathcal Z)=1$
\end{enumerate}
Ein Problem $\Pi$ heißt \textit{$NP$-schwierig}\index{NP!-schwierig}, falls jedes Problem aus $NP$ polynomiell auf $\Pi$ reduzierbar ist. $\Pi$ heißt \textit{$NP$-leicht}\index{NP!-leicht}, falls es Problem $\Pi'$ aus $NP$ gibt, auf das $\Pi$ polynomiell reduzierbar ist. $\Pi$ heißt \textit{$NP$-äquivalent}\index{NP!-äquivalent}, falls $\Pi$ $NP$-leicht und $NP$-schwierig ist.
\subsubsection{Beispiel}\ssslbl
Hamiltonkreis: Polynomiell lösbar? Offen\\[1ex]
Hamiltonkreis $\in NP$. Zertifikat: Kodierung (String) eines Hamiltonkreises:\\[1ex]
$\mathcal A$: überprüft, ob gegebener String Hamiltonkreis kodiert.
\subsubsection{Bezeichnung}\ssslbl
Boolsche Variable v: Werte 'wahr' (1) oder 'falsch' (0); Funktion $\omega:V\rightarrow\{\text{wahr},\text{falsch}\}$ \textit{Wahrheitswertezuweisung}\index{Wahrheitswertezuweisung}, $V$ Menge Boolescher Variablen.\\[1ex]
Operationen: $\wedge,\vee,\neg$ \textit{elementare Boolesche Operationen}\index{Operation!Boolesche!elementare}, $v$ Boolesche Variable: $v$, $\neg v$ \textit{Literal}\index{Literal}\\[1ex]
\textit{Boolescher Ausdruck}\index{Ausdruck!Boolescher}: mittels $\wedge,\vee$ Klammerung von Literalen gebildet\\[1ex]
\textit{Boolescher Ausdruck erfüllbar}\index{Ausdruck!Boolescher!erfüllbarer}: es gibt Wahrheitswertezuweisung, für die Ausdruck wahr wird.\\[1ex]
Seien $V$ eine endliche Menge Boolescher Variablen, $k\in\mathbb N$, $x_1,\dots,x_k$ Literale (über $V$). Dann heißt $(x_1\vee x_2\vee\dots\vee x_k)$ \textit{Klausel}\index{Klausel} über $V$. Sind $C_1,\dots,C_m$ Klauseln über $V$, so heißt $C_1\wedge C_2\wedge\dots\wedge C_m$ Boolescher Ausdruck in konjunktiver Normalform.
\subsubsection{Bezeichnung}\ssslbl
Das Problem \textit{Satisfiability}\index{Satisfiability} oder \textit{Erfüllbarkeit}\index{Erfüllbarkeit} Boolescher Ausdrücke besteht aus folgenden Aufgaben:
\begin{itemize}
\item Gegeben: $m,n\in\mathbb N$, $V=\{v_1,\dots,v_n\}$ Boolesche Variablen, $\zeta=\{C_1,\dots,C_m\}$ Klauseln über $V$
\item Frage: Existiert eine alle Klauseln von $\zeta$ erfüllende Wahrheitswertezuordnung?
\end{itemize}
\subsubsection{Satz. Satz von Cook\index{Cook!Satz von}}\ssslbl
Satisfiability ist $NP$-schwierig.
\subsubsection{Bezeichung}\ssslbl
Partition ist das folgende Problem:
\begin{itemize}
\item Gegeben: $n\in\mathbb N$, $\alpha_1,\dots,\alpha_n\in\mathbb N$
\item Frage: Gibt es Partition $(I,J)$ von $[n]$ mit $\sum_{i\in I}\alpha_i=\sum_{j\in J}\alpha_j$
\end{itemize}
\subsubsection{Satz}\ssslbl
Partition ist $NP$-schwierig
\subsubsection{Bezeichung}\ssslbl
Das Problem:
\begin{itemize}
\item Gegeben: $n,m\in\mathbb N$, $A\in\mathbb Z^{m\times n}$, $b\in\mathbb Z$
\item Auftrag: $\max\sum_{i=1}^n\xi_i^2$ bezüglich $Ax\leq b$, heißt \textit{NormMax}\index{NormMax}
\end{itemize}
\subsubsection{Korollar}\ssslbl
NormMax ist $NP$-schwierig
\subsubsection*{Beweis}
Seien $\mathcal I:=(i,\alpha_1,\dots,\alpha_n)$ eine Aufgabe von Partition und $a=(\alpha_1,\dots,\alpha_n)^T$\\[1ex]
Es gilt:
\[x\in[-1,1]^n\:\Rightarrow\:\sum_{i=1}^n\xi_i^2\leq n\]
mit
\[=\:\Leftrightarrow\:x\in\{-1,1\}^n\]
Daher ist $\mathcal I$ genau dann Ja-Instanz von Partition, wenn
\[\max\left\{\sum_{i=1}^n\xi_i^2\::\:a^Tx=0\:\wedge\:-1\leq x\leq1\right\}=n\]
Mit $A^T=(a,-a,E_n,-E_n)$, $b=(0,\dots,0,1,\dots,1)^T$, $\gamma=n$  ist Existenz von $x$ mit $Ax\leq b$, $\Vert x\Vert^2\geq\gamma$ äquivalent zur Tatsache, dass $\mathcal I$ Ja-Instanz von Partition ist.
\subsubsection{Satz}\ssslbl
Intervallpflasterung ist $NP$-schwierig.\\[1ex]
$\alpha_1,\dots,\alpha_n$, $a=(\alpha_1,\dots,\alpha_n)^T$, $a^tx=\beta$, $x\geq0$, $x\in\mathbb Z^n$ ILP $NP$-schwierig.
\subsection{Mehrstufige Entscheidungsprozesse: Dynamische Optimierung, kürzeste Wege und weitere Probleme}\sslbl
\subsubsection{Beispiel}\ssslbl
Gegeben: Montagestraße, Montagestationen werden als Knoten $v_1,\dots,v_{11}$ eines Digraphen modelliert. $s=v_1,$, $t=v_{11}$, Kanten geben mögliche Abläufe von Station zu Station an. Fertigung muss alle Stufen durchlaufen. Gesamtmontagen entsprechen $s-t$-Weg
\begin{center}
\begin{tikzpicture}[>=stealth']
\tikzstyle{every label}=[red]
\foreach \n/\i/\j/\k in {{2/4/-2/1}, {3/4/0/1}, {4/4/2/2}, {5/8/-2/1}, {6/8/0/2}, {7/8/2/2}, {8/12/-2/3}, {9/12/0/1}, {10/12/2/2}}
  \node[vertex,label=below:$\k$] (v\n) at (\i,\j) {$v_{\n}$};
\node[vertex,label=below:0] (v1) at (0,0) {$s$};
\node[vertex,label=below:0] (v11) at (16,0) {$t$};
\foreach \i/\j/\g in {{1/2/3}, {1/3/5}, {1/4/3}, {2/5/1}, {4/7/1}, {5/8/2}, {6/9/2}, {7/10/1}, {8/11/2}, {9/11/1}, {10/11/2}}
  \path[arrow] (v\i) to (v\j) node[color = green!60!black, midway, above] {$\g$};
  
\path[arrow] (v2) to (v6) node[color = green!60!black,near start, above] {$3$};
\path[arrow] (v3) to (v5) node[color = green!60!black,near start, above] {$2$};
\path[arrow] (v3) to (v7) node[color = green!60!black,near start, above] {$1$};
\path[arrow] (v4) to (v6) node[color = green!60!black,near start, above] {$2$};

\path[arrow] (v5) to (v9) node[color = green!60!black,near start, above] {$1$};
\path[arrow] (v6) to (v8) node[color = green!60!black,near start, above] {$1$};
\path[arrow] (v6) to (v10) node[color = green!60!black,near start, above] {$1$};
\path[arrow] (v7) to (v9) node[color = green!60!black,near start, above] {$3$};

\filldraw[nearly transparent, rounded corners=2pt, fill=blue!80!white,draw=blue] (3.5,-3) rectangle (4.5,3);
\filldraw[nearly transparent, rounded corners=2pt, fill=blue!80!white,draw=blue] (7.5,-3) rectangle (8.5,3);
\filldraw[nearly transparent, rounded corners=2pt, fill=blue!80!white,draw=blue] (11.5,-3) rectangle (12.5,3);

\draw[rounded corners=7pt, orange!80!white] (-1,0) -- (4,-3) -- (9,0) -- (4,3) -- cycle;
\draw[rounded corners=7pt, orange!80!black] (7,0) -- (12,-3) -- (17,0) -- (12,3) -- cycle;

\path[arrow,blue,thick] (v1) to (v2);
\path[arrow,blue,thick] (v2) to (v5);
\path[arrow,blue,thick] (v5) to (v9);
\path[arrow,blue,thick] (v9) to (v11);
\end{tikzpicture}\\
\emph{\textcolor{red}{Montagekosten $\nu_i$}, \textcolor{green!60!black}{Transferkosten $\tau_{i,j}$}, \textcolor{orange!80!white}{$s-v_6$-Weg}, \textcolor{orange!80!black}{$v_6-t$-Weg}, \textcolor{blue}{optimaler Montageplan}}
\end{center}
Gesucht: minimale Gesamtkosten (Ausführungszeit, $\dots$). Betrachte Weg durch $v_6$: Gesucht ist optimaler $s-v_6$-Weg und $v_6-t$-Weg.
\hfill\textbf{05.12.2008}\\
\begin{align*}
\alpha(v_i) &= \text{minimale (Zeit-)Kosten bis einschließlich $v_i$}\\
\alpha(s) &= 0\\
\alpha(v_2) &= 3 + 1 = 4\\
\alpha(v_i) &= \alpha(v_1) + \tau_{1,i} + \nu_i \qquad(i=2,3,4)\\
\alpha(v_5) &= \min\{\alpha(v_i)+\tau_{i,5}+\nu_5:\ i=2,3\}\\
  &= \min\{4+1+1, 6+2+1\} = 6\\
\alpha(v_6) &= \min\{4+3+2,5+2+2\}=9\\
\alpha(t) &= 9 \qquad\text{(optimaler Montageplan)}
\end{align*}
\textbf{Wichtig:} \textit{Schichtstruktur}, Vergangenheit (wie genau kommt man zu Knoten der Stufe $k-1$) irrelevant, relevant nur "`wie schnell"'. Entscheidungen hängen nur von Daten ($\alpha(v_i)$) der Vorgängerstufe und den verursachten Zeiten ($\tau_{i,j}, \nu_i$) ab (\textit{Markoff-Eigenschaft}\index{Markoff-Eigenschaft}).
\subsubsection{Definition}\ssslbl
Seien $G = (V,E)$ ein gerichteter Graph, $p \in \mathbb N_p$. Dann heißt $G$ \textit{Schicht-} oder \textit{Stufengraph}\index{Graph!Schicht-}\index{Graph!Stufen-}, wenn es $s, t \in V$ sowie \textit{zugehörige Partitionen} $(V_0,\dots,V_p)$ von $V$, $(E_1,\dots,E_p)$ von $E$ gibt mit $V_0 = \{s\}$, $V_p = \{t\}$ und $E_k \subset V_{k-1} \times V_k$ $(k \in [p])$. $V_k$ heißt \textit{$k$-te Stufe (Schicht)}\index{Stufe}\index{Schicht}.
\subsubsection{Definition}\ssslbl
Seien $G = (V,E)$ Schichtgraph, $(V_0,\dots,V_p)$, $(E_0,\dots,E_p)$ zugehörige Partitionen von $V$ bzw. $E$. $V_k$ \textit{Menge aller Zustände}, $E_k$ \textit{Menge aller Entscheidungen}.
\[\psi_k: E_k \to \mathbb R \quad (k \in [p]) \qquad \text{$k$-te \textit{Stufenkostenfunktion}}\]
Sei $X$ Menge aller Tupel $x = (e_1,\dots,e_p) \in E_1 \times \cdots \times E_p$, deren Kanten einen $s$-$t$-Weg in $G$ bilden. $x \in X$ heißt \textit{Politik}\index{Politik}.\\
Zielfunktion $\varphi: X \to \mathbb R$ ist für $x = (e_1,\dots,e_p) \in X$ definiert durch
\[\varphi(x) := \sum_{k=1}^p \psi_k(e_k).\]
Minimierung von $\varphi$: \textit{$p$-stufiger Entscheidungsprozess}\index{Entscheidungsprozess} \textit{(Modell der (diskreten) dynamischen Optimierung)}
\subsubsection{Satz \textit{(Bellmansches Optimalitätsprinzip)}\index{Optimalitätsprinzip!Bellmansches}}\ssslbl
Gegeben: $p$-stufiger Entscheidungsprozess, $x^* = (e_1^*,\dots,e_p^*) \in X$ optimale Politik, $e_k^* = v_{k-1}^*, v_k^*)$. $x_{k,1}^* = (e_1^*,\dots,e_k^*)$, $x_{k,2}^* = (e_{k+1}^*,\dots,e_p^*)$.\\
Seien $G_{k,1}$, $G_{k,2}$ die durch $\{v_k^*\} \cup \bigcup_{i=0}^{k-1} V_i$ bzw. $\{v_k^*\} \cup \bigcup_{i=k+1}^{p} V_i$ induzierten Teilgraphen von $G$. Dann sind $x_{k,1}^*$ bzw. $x_{k,2}^*$ optimale Politiken für den durch $G_{k,1}$ bzw. $G_{k,2}$ gegebenen Entscheidungsprozess.
\subsubsection*{Beweis}
Da $x^*$ optimal ist, gibt es eine optimale Politik, die sich in Stufe $k$ in Zustand $v_k^*$ befindet. Gäbe es $s$-$v_k^*$-Weg $x_1$ mit kleineren Kosten als $x_{k,1}^*$, so wäre $(x_1, x_{k,2}^*$ eine bessere Politik als $x^*$.
\subsubsection{Prozedur: Dynamische Optimierung (Vorwärtsrekursion)\index{Optimierung!dynamische}}\ssslbl
\lstset{mathescape=true}
\begin{lstlisting}
INPUT Spezifikation $(p,V_0,\dots,V_p,E_1,\dots,E_p,\psi_1,\dots,\psi_p)$ eines
      mehrstufigen Entscheidungsprozesses mit $V_0=\{s\}$, $V_p=\{t\}$
OUTPUT Minimum $\alpha(t)$ der zugehörigen Zielfunktion $\varphi$
BEGIN $\alpha(s)\leftarrow 0$
   FOR ALL $v \in V \setminus \{s\}$ DO $\alpha(v) \leftarrow \infty$
   FOR $k=1,\dots,p$ DO
      BEGIN
         FOR ALL $w \in V_k$ DO
            $\alpha(w) \leftarrow \min\{\alpha(v)+\psi_k(v,w):\ (v,w) \in E_k\}$
      END
END
\end{lstlisting}
\subsubsection{Bezeichnung}\ssslbl
Das Problem:\\[1ex]
Gegeben: $n\in\mathbb N, \tau_1,\dots,\tau_n,\rho\in\mathbb N, \gamma_1,\dots,\gamma_n\in\mathbb N$.\\
Auftrag: Finde $I^*\subset[n]$ mit $I^* \in argmax_{I\subset[n]}\left\{\sum_{i\in I}\gamma_i:\ \sum_{i\in I}\tau_i\leq\rho\right\}$
\\[1ex]
heißt \textit{Rucksack-Problem}\index{Problem!Rucksack-} \textit{(englisch: knapsack)}.
\subsubsection{Beispiel}\ssslbl
Gegenstände $G_1,G_2,G_3,G_4$, Gewichte $\tau_1=2,\tau_2=3,\tau_3=4,\tau_4=6$, Nutzen $\gamma_1=1,\gamma_2=4,\gamma_3=5,\gamma_4=1$, Fassungsvermögen $\rho=9$.\\
\textit{Entscheidungen}: Soll $G_k$ in den Rucksack gepackt werden?\\
\textit{Zustände}: Restkapazität.\\
\textit{Mastergraph}:
\begin{center}
\begin{tikzpicture}[>=stealth']
\foreach \j in {0,...,9} {
  \node[left] at (0,4.5-0.5*\j) {\scriptsize\j};
  \draw[help lines] (0,4.5-0.5*\j) to (4,4.5-0.5*\j);
  \foreach \i in {1,2,3,4}
    \node[vertexpt] (v\i\j) at (\i,4.5-0.5*\j) {};
}
\node[vertexpt] (v09) at (0,0) {};
\node[vertexpt] (v50) at (5,2.25) {};
\foreach \i in {1,2,3,4}
  \path (\i-1,4.5) to node[above] {$G_\i$} (\i,4.5);
\foreach \i in {0,...,5}
  \path (\i,0) node[below] {\scriptsize\i};
\path (0,-0.5) to node {\scriptsize Stufe ($i$)} (5,-0.5);
\path (-0.5,0) to node[rotate=90] {\scriptsize Restkapazität ($j$)} (-0.5,4.5);
\foreach \a/\b in {09/17,09/19,
                   17/24,17/27,19/26,19/29,
                   24/30,24/34,26/32,26/36,27/33,27/37,29/35,29/39,
                   30/40,32/42,33/43,34/44,35/45,36/40,36/46,37/41,37/47,39/43,39/49,
                   40/50,41/50,42/50,43/50,44/50,45/50,46/50,47/50,48/50,49/50}
  \path[arrow] (v\a) to (v\b);
\foreach \a/\b in {09/17,17/24,24/30,30/40,40/50}
  \path[arrow,blue,thick] (v\a) to (v\b);
\end{tikzpicture}
\end{center}

Knoten $v_{i,j}$, $s = v_{0,9}$
\begin{align*}
E_1 &= \{(v_{0,9},v_{1,9}),(v_{0,9},v_{1,7})\}\\
E_5 &= \{(v_{4,i},v_{5,0}):\ i\}
\end{align*}
Für $k = 2,3,4$:
\begin{align*}
E_k' &=\{(v_{k-1,i},v_{k,i}):\ i\}\\
E_k'' &=\{(v_{k-1,i},v_{k,j}):\ i, j=i-\tau_k\geq0\}\\
E_k &= E_k' \cup E_k''\\
\end{align*}
\[\psi_k(e) := \begin{cases}\gamma_k & e \in E_k\\0 & \text{sonst}\end{cases}\]
$\alpha(w) \leftarrow \max\{\alpha(v) + \psi_k(v,w):\ (v,w)\in E_k\}$\\
Vorwärtsrekursion:
\begin{align*}
\alpha(v_{0,9}) &= 0\\
\alpha(v_{1,7}) &= 1 &\alpha(v_{1,9}) &= 0\\
\alpha(v_{2,4}) &= 5 &\alpha(v_{2,6}) &= 4 &\alpha(v_{2,7}) &= 1 &\alpha(v_{2,9}) &= 0\\
&\vdots\\
\alpha(v_{5,0}) &= 10
\end{align*}
Auswahl: $\{G_1,G_2,G_3\}$\hfill\textbf{09.12.2008}
\subsubsection{Prozedur: Knapsack-Algorithmus\index{Algorithmus!Knapsack}}\ssslbl
\begin{lstlisting}
INPUT Aufgabe $(n,\tau_1,\dots,\tau_n\rho,\gamma_1,\dots,\gamma_n)$ des Rucksackproblems
OUTPUT Maximaler Gesamtnutzen $\zeta^*$ (Güterauswahl)
BEGIN $\alpha(0,\rho)\leftarrow0$
  FOR $k=0,\dots,n$ DO $V_k\leftarrow\{\rho\}$
  FOR $k=1,\dots,n$ DO
    BEGIN
      FOR ALL $\eta\in V_{k-1}$ DO
        IF $\eta\geq\tau_k$ THEN
          $V_k\leftarrow V_k\cup\{\eta-\tau_k\}$
        END
      END
      FOR ALL $\eta\in V_k$ DO
        $\alpha(k,\eta)\leftarrow\max\bigl\{\{\alpha(k-1,\eta)\::\:\eta\in V_{k-1}\}\cup\{\alpha(k-1,\eta+\tau_k)+\gamma_k\::\:\eta-\tau_k\in V_k\}\bigl\}$
      END
    END
  END
  $\zeta^*\leftarrow\max\{\alpha(n,\eta)\::\:\eta\in V_n\}$
END
\end{lstlisting}
\subsubsection{Satz}\ssslbl
Für jede durch $\mathcal I:=(n,\tau_1,\dots,\tau_n,\rho,\gamma_1,\dots,\gamma_n)$ spezifizierte Aufgabe von Knapsack löst Prozedur \textit{(\ref{6.2.8})} das Rucksackproblem in $\mathcal O(n\rho)$ Operationen. Die Größe der auftretenden Zahlen ist durch $\mathcal O\bigl(\size(\mathcal I)\bigr)$ beschränkt.
\subsubsection*{Beweis}
Übung\\[1ex]
Algorithmus ist nur pseudopolynomiell, Knapsack ist NP-schwer.
\subsubsection{Definition}\ssslbl
Eine Aufgabe \textit{Kürzester Kantenzug}\index{Kantenzug!kürzester} ist spezifiziert durch: $G=(V,E,\nu)$ allgemeiner Graph, $s,t\in V$, $\Phi:E\rightarrow\mathbb R$. Seien $\mathcal K$ die Menge aller $s-t$-Kantenzüge, $\varphi:\mathcal K\rightarrow\mathbb R$ zugehörige Zielfunktion definiert durch
\[\varphi(W)=\sum_{i=1}^p\Phi(e_i)\:,\qquad W=(s,e_1,\dots,e_p,t)\in\mathcal K\]
Ziel: minimiere $\varphi$ über $\mathcal K$.\\[1ex]
Wird statt über $\mathcal K$ über die Menge $\mathcal E$ aller einfachen Kantenzüge bzw. über die Menge $\mathcal W$ aller $s-t$-Wege optimiert, so spricht man von \textit{Aufgabe kürzester einfacher Kantenzug}\index{Kantenzug!kürzester!einfacher} bzw. Wege.\\[1ex]
[Abk.: SPP: shortest path problem: $\mathcal W$]
\subsubsection{Beispiel}\ssslbl
\begin{center}
\begin{tikzpicture}
\node[vertex] (v1) at (0,0) {$s$};
\node[vertex] (v2) at (1.5,1.5) {$v_2$};
\node[vertex] (v3) at (0,3) {$v_3$};
\node[vertex] (v4) at (3,3) {$v_4$};
\node[vertex] (v5) at (3,0) {$t$};

\path[arrow] (v1) to (v2) node[midway, above] {\begin{small}$1$\end{small}};
\path[arrow] (v2) to (v3) node[midway, above] {\begin{small}$-1$\end{small}};
\path[arrow] (v3) to (v4) node[midway, above] {\begin{small}$-1$\end{small}};
\path[arrow] (v4) to (v2) node[midway, above] {\begin{small}$-1$\end{small}};
\path[arrow] (v2) to (v5) node[midway, above] {\begin{small}$1$\end{small}};
\end{tikzpicture}\\
\emph{Graph $G$}\\
\begin{tikzpicture}
\node[vertex] (v1) at (0,0) {$s$};
\node[vertex] (v2) at (1.5,1.5) {$v_2$};
\node[vertex] (v3) at (0,3) {$v_3$};
\node[vertex] (v4) at (3,3) {$v_4$};
\node[vertex] (v5) at (3,0) {$t$};

\path[arrow, orange, very thick] (v1) to (v2) node[midway, above] {\begin{small}$1$\end{small}};
\path[arrow] (v2) to (v3) node[midway, above] {\begin{small}$-1$\end{small}};
\path[arrow] (v3) to (v4) node[midway, above] {\begin{small}$-1$\end{small}};
\path[arrow] (v4) to (v2) node[midway, above] {\begin{small}$-1$\end{small}};
\path[arrow, orange, very thick] (v2) to (v5) node[midway, above] {\begin{small}$1$\end{small}};
\end{tikzpicture}\hspace{1cm}
\begin{tikzpicture}
\node[vertex] (v1) at (0,0) {$s$};
\node[vertex] (v2) at (1.5,1.5) {$v_2$};
\node[vertex] (v3) at (0,3) {$v_3$};
\node[vertex] (v4) at (3,3) {$v_4$};
\node[vertex] (v5) at (3,0) {$t$};

\path[arrow, red, very thick] (v1) to (v2) node[midway, above] {\begin{small}$1$\end{small}};
\path[arrow, red, very thick] (v2) to (v3) node[midway, above] {\begin{small}$-1$\end{small}};
\path[arrow, red, very thick] (v3) to (v4) node[midway, above] {\begin{small}$-1$\end{small}};
\path[arrow, red, very thick] (v4) to (v2) node[midway, above] {\begin{small}$-1$\end{small}};
\path[arrow, red, very thick] (v2) to (v5) node[midway, above] {\begin{small}$1$\end{small}};
\end{tikzpicture}\hspace{1cm}
\begin{tikzpicture}
\node[vertex] (v1) at (0,0) {$s$};
\node[vertex] (v2) at (1.5,1.5) {$v_2$};
\node[vertex] (v3) at (0,3) {$v_3$};
\node[vertex] (v4) at (3,3) {$v_4$};
\node[vertex] (v5) at (3,0) {$t$};

\path[arrow, blue, very thick] (v1) to (v2) node[midway, above] {\begin{small}$1$\end{small}};
\path[arrow, blue, very thick] (v2) to (v3) node[midway, above] {\begin{small}$-1$\end{small}};
\path[arrow, blue, very thick] (v3) to (v4) node[midway, above] {\begin{small}$-1$\end{small}};
\path[arrow, blue, very thick] (v4) to (v2) node[midway, above] {\begin{small}$-1$\end{small}};
\path[arrow, blue, very thick, dotted] (v2) to (v5) node[midway, above] {\begin{small}$1$\end{small}};
\draw[->, blue, very thick] (1.5,2.75) arc(90:-250:0.3cm);
\end{tikzpicture}\\
\emph{\textcolor{orange}{Optimum bez. $\mathcal W$: 2}, \textcolor{red}{Optimum bez. $\mathcal E$: -1}, \textcolor{blue}{Optimum bez. $\mathcal K$ existiert nicht, bzw. $-\infty$}}
\end{center}
\subsubsection{Lemma}\ssslbl
Durch $(G,s,t,\Phi)$ sei Aufgabe kürzester Kantenzüge oder einfacher Kantenzüge bzw. Wege spezifiziert, $\varphi$ zugehörige Zielfunktion, $\mathcal K$, $\mathcal E$, $\mathcal W$ wie in \textit{(\ref{6.2.10})}. Dann gilt:
\begin{enumerate}[(a)]
\item Das Minimum von $\varphi$ über $\mathcal E$ bzw. $\mathcal W$ existiert genau dann, wenn $\mathcal W\neq\emptyset$ ist.
\item Das Minimum über $\mathcal K$ existiert genau dann, wenn $\mathcal K\neq\emptyset$ ist, aber kein Kantenzug von $s$ nach $t$ einen Knoten enthält, der in einem geschlossenen Kantenzug negativer Länge liegt.
\item Wird Minimum über $\mathcal K$ angenommen, so existiert ein $s-t$-Weg gleicher minimaler Länge.
\item Ist $\mathcal K\neq\emptyset$, $\Phi>0$, so ist jeder minimaler $s-t$-Kantenzug ein Weg.
\end{enumerate}
\subsubsection*{Beweis}
$\checkmark$\\[2ex]
Für $\Phi\geq0$ Graph vereinfachen schlingenfrei, $\dots$: Dynamsiche Optimierung
\subsubsection{Beispiel}\ssslbl
\begin{center}
\begin{tikzpicture}
\node[vertex] (v1) at (0,0) {$s$};
\node[vertex] (v2) at (2,-1.5) {$v_2$};
\node[vertex] (v3) at (2,1.5) {$v_3$};
\node[vertex] (v4) at (4,0) {$t$};

\path[arrow] (v1) to (v2) node[midway, below] {$e_2$} node[midway,above,red,very thick] {4};
\path[arrow] (v1) to (v3) node[midway, below] {$e_1$} node[midway,above,red,very thick] {1};
\path[arrow] (v2) to (v4) node[midway, below] {$e_6$} node[midway,above,red,very thick] {1};
\path[arrow] (v3) to (v4) node[midway, below] {$e_5$} node[midway,above,red,very thick] {5};
\path[arrow, bend left] (v2) to (v3) node[midway, left] {$e_3$} node[midway, right,red,very thick] {$\tau$};
\path[arrow, bend left] (v3) to (v2) node[midway, right] {$e_4$} node[midway, left,red,very thick] {3};
\end{tikzpicture}\\
\emph{Digraph $G$, \textcolor{red}{$\tau\in\mathbb Z$}}
\end{center}
$G$ besitzt genau einen Kreis $(e_3,e_4)$ der Länge
\[\begin{cases}>0&\tau\geq-2\\=0&\tau=-3\\<0&\tau\leq-4\end{cases}\]
\begin{center}
\begin{tikzpicture}
\node (v1) at (-1,3) {$v_1$};
\node (v2) at (-1,2) {$v_2$};
\node (v3) at (-1,1) {$v_3$};
\node (v4) at (-1,0) {$v_4$};
\node[vertexpt,label={[red,very thick]below:0},label={[blue,very thick]above:0}] (v01) at (0,3) {};
\node[vertexpt,label={[red,very thick]below:4},label={[blue,very thick]above:4}] (v12) at (2,2) {};
\node[vertexpt,label={[red,very thick]below:1},label={[blue,very thick]above:1}] (v13) at (2,1) {};
\node[vertexpt,label={[red,very thick]below:4},label={[blue,very thick]above:4}] (v22) at (4,2) {};
\node[vertexpt,label={[red,very thick]below:5},label={[blue,very thick]above:-2}] (v23) at (4,1) {};
\node[vertexpt,label={[red,very thick]below:5},label={[blue,very thick]above:5}] (v24) at (4,0) {};
\node[vertexpt,label={[red,very thick]below:8},label={[blue,very thick]above:1}] (v32) at (6,2) {};
\node[vertexpt,label={[red,very thick]below:5},label={[blue,very thick]above:-2}] (v33) at (6,1) {};
\node[vertexpt,label={[red,very thick]below:5},label={[blue,very thick]above:3}] (v34) at (6,0) {};
\node[vertexpt,label={[red,very thick]below:8},label={[blue,very thick]above:1}] (v42) at (8,2) {};
\node[vertexpt,label={[red,very thick]below:9},label={[blue,very thick]above:-5}] (v43) at (8,1) {};
\node[vertexpt,label={[red,very thick]below:5},label={[blue,very thick]above:2}] (v44) at (8,0) {};
\node[vertexpt,label={[red,very thick]below:12},label={[blue,very thick]above:-2}] (v52) at (10,2) {};
\node[vertexpt,label={[red,very thick]below:9},label={[blue,very thick]above:-5}] (v53) at (10,1) {};
\node[vertexpt,label={[red,very thick]below:5},label={[blue,very thick]above:0}] (v54) at (10,0) {};
\node[vertexpt,label={[red,very thick]below:5},label={[blue,very thick]above:-1}] (v64) at (12,0) {};

\path[arrow] (v01) to (v12);
\path[arrow] (v01) to (v13);

\path[arrow] (v12) to (v23);
\path[arrow] (v12) to (v24);
\path[arrow] (v13) to (v22);
\path[arrow] (v13) to (v24);

\path[arrow] (v22) to (v33);
\path[arrow] (v22) to (v34);
\path[arrow] (v23) to (v32);
\path[arrow] (v23) to (v34);
\path[arrow] (v24) to (v34);

\path[arrow] (v32) to (v43);
\path[arrow] (v32) to (v44);
\path[arrow] (v33) to (v42);
\path[arrow] (v33) to (v44);
\path[arrow] (v34) to (v44);

\path[arrow] (v42) to (v53);
\path[arrow] (v42) to (v54);
\path[arrow] (v43) to (v52);
\path[arrow] (v43) to (v54);
\path[arrow] (v44) to (v54);

\path[arrow] (v52) to (v64);
\path[arrow] (v53) to (v64);
\path[arrow] (v54) to (v64);

\filldraw[nearly transparent, rounded corners=2pt, fill=blue!80!white,draw=blue] (-0.5,-0.5) rectangle (0.5,3.5);
\filldraw[nearly transparent, rounded corners=2pt, fill=blue!80!white,draw=blue] (1.5,-0.5) rectangle (2.5,3.5);
\filldraw[nearly transparent, rounded corners=2pt, fill=blue!80!white,draw=blue] (3.5,-0.5) rectangle (4.5,3.5);
\filldraw[nearly transparent, rounded corners=2pt, fill=blue!80!white,draw=blue] (5.5,-0.5) rectangle (6.5,3.5);
\filldraw[nearly transparent, rounded corners=2pt, fill=blue!80!white,draw=blue] (7.5,-0.5) rectangle (8.5,3.5);
\filldraw[nearly transparent, rounded corners=2pt, fill=blue!80!white,draw=blue] (9.5,-0.5) rectangle (10.5,3.5);
\filldraw[nearly transparent, rounded corners=2pt, fill=blue!80!white,draw=blue] (11.5,-0.5) rectangle (12.5,3.5);
\foreach \i/\j in {0/0,1/2,2/4,3/6,4/8,5/10,6/12}
  \node at (\j,-1) {\i};
\end{tikzpicture}\\
\emph{\textcolor{red}{$\tau=1$}, \textcolor{blue}{$\tau=-6$}}
\end{center}
$V_0=\{v_{0,1}\}$, $V_1=\{v_{1,2},v_{1,3}\}$, $V_6=\{v_{6,4}\}$, $V_k=\{v_{k,2},v_{k,3},v_{k,4}\}$ $k=2,\dots,5$, Kanten entsprechend\\[2ex]
Operationen $\mathcal O(n^2p)$, $n=\vert V\vert$, $p$ maximale Länge der Kantenzüge\\[1ex]
Keine Kreise negativer Länge, wähle $p=n$ $\rightarrow$ $\mathcal O(n^3)$\\[1ex]
Jetzt $\Phi\geq0$ Ziel $O(n^2)$ Algorithmus (spare Updates in Dynamischer Optimierung)
\subsubsection{Beispiel}\ssslbl
\begin{center}
\begin{tikzpicture}
\node[vertex] (v1) at (0,0) {$s$};
\node[vertexpt] (v2) at (2,-2) {};
\node[vertexpt] (v3) at (2,0) {};
\node[vertexpt] (v4) at (2,2) {};
\node[vertexpt] (v5) at (4,-1) {};
\node[vertexpt] (v6) at (4,1) {};
\node[vertex] (v7) at (6,0) {$t$};

\path[arrow] (v1) to (v2) node[midway,below] {2};
\path[arrow] (v1) to (v3) node[midway,above] {1};
\path[arrow] (v1) to (v4) node[midway,above] {3};
\path[arrow] (v2) to (v3) node[midway,right] {1};
\path[arrow] (v3) to (v4) node[midway,right] {1};
\path[arrow] (v2) to (v5) node[midway,below] {1};
\path[arrow] (v4) to (v6) node[midway,above] {3};
\path[arrow] (v5) to (v6) node[midway,right] {1};
\path[arrow] (v5) to (v7) node[midway,below] {6};
\path[arrow] (v6) to (v7) node[midway,above] {2};
\end{tikzpicture}
\end{center}
\hfill\textbf{12.12.2008}\\
$S^{(0)}=\{v_1\}$, jeweils aktuelle Knotenmenge $S^{(k)}$, Abbruch: $t=v_7\in S^{(k)}$\\[1ex]
Label $\xi^{(k)}(v)$ Länge eines kürzesten $s-v$-Weges, der ausschließlich Zwischenknoten aus $S^{(k)}$ enthält.\\[1ex]
Gibt ($v\in S^{(k)}$ $\Rightarrow$ $\xi^{(k)}(v)$ Länge kürzester $s-v$-Wege)\\
\begin{center}
\begin{tikzpicture}
\node[vertexpt,label={[blue,very thick]left:0}] (v1) at (0,0) {};
\node[vertexpt,label={[red,very thick]below:2}] (v2) at (1,-1) {};
\node[vertexpt,label={[red,very thick]right:1}] (v3) at (1,0) {};
\node[vertexpt,label={[red,very thick]above:3}] (v4) at (1,1) {};
\node[vertexpt,label={[red,very thick]below:$\infty$}] (v5) at (2,-0.5) {};
\node[vertexpt,label={[red,very thick]above:$\infty$}] (v6) at (2,0.5) {};
\node[vertexpt,label={[red,very thick]right:$\infty$}] (v7) at (3,0) {};

\path[arrow] (v1) to (v2);
\path[arrow] (v1) to (v3);
\path[arrow] (v1) to (v4);
\path[arrow] (v2) to (v3);
\path[arrow] (v3) to (v4);
\path[arrow] (v2) to (v5);
\path[arrow] (v4) to (v6);
\path[arrow] (v5) to (v6);
\path[arrow] (v5) to (v7);
\path[arrow] (v6) to (v7);
\node[blue,very thick] at (1.5,-2) {$S^{(0)}$};
\end{tikzpicture}\hspace{1cm}
\begin{tikzpicture}
\node[vertexpt,label={[blue,very thick]left:0}] (v1) at (0,0) {};
\node[vertexpt,label={[red,very thick]below:2}] (v2) at (1,-1) {};
\node[vertexpt,label={[blue,very thick]right:1}] (v3) at (1,0) {};
\node[vertexpt,label={[red,very thick]above:2}] (v4) at (1,1) {};
\node[vertexpt,label={[red,very thick]below:$\infty$}] (v5) at (2,-0.5) {};
\node[vertexpt,label={[red,very thick]above:$\infty$}] (v6) at (2,0.5) {};
\node[vertexpt,label={[red,very thick]right:$\infty$}] (v7) at (3,0) {};

\path[arrow] (v1) to (v2);
\path[arrow] (v1) to (v3);
\path[arrow] (v1) to (v4);
\path[arrow] (v2) to (v3);
\path[arrow] (v3) to (v4);
\path[arrow] (v2) to (v5);
\path[arrow] (v4) to (v6);
\path[arrow] (v5) to (v6);
\path[arrow] (v5) to (v7);
\path[arrow] (v6) to (v7);
\node[blue,very thick] at (1.5,-2) {$S^{(1)}$};
\end{tikzpicture}\hspace{1cm}
\begin{tikzpicture}
\node[vertexpt,label={[blue,very thick]left:0}] (v1) at (0,0) {};
\node[vertexpt,label={[blue,very thick]below:2}] (v2) at (1,-1) {};
\node[vertexpt,label={[blue,very thick]right:1}] (v3) at (1,0) {};
\node[vertexpt,label={[red,very thick]above:2}] (v4) at (1,1) {};
\node[vertexpt,label={[red,very thick]below:3}] (v5) at (2,-0.5) {};
\node[vertexpt,label={[red,very thick]above:$\infty$}] (v6) at (2,0.5) {};
\node[vertexpt,label={[red,very thick]right:$\infty$}] (v7) at (3,0) {};

\path[arrow] (v1) to (v2);
\path[arrow] (v1) to (v3);
\path[arrow] (v1) to (v4);
\path[arrow] (v2) to (v3);
\path[arrow] (v3) to (v4);
\path[arrow] (v2) to (v5);
\path[arrow] (v4) to (v6);
\path[arrow] (v5) to (v6);
\path[arrow] (v5) to (v7);
\path[arrow] (v6) to (v7);
\node[blue,very thick] at (1.5,-2) {$S^{(2)}$};
\end{tikzpicture}\\
\begin{tikzpicture}
\node[vertexpt,label={[blue,very thick]left:0}] (v1) at (0,0) {};
\node[vertexpt,label={[blue,very thick]below:2}] (v2) at (1,-1) {};
\node[vertexpt,label={[blue,very thick]right:1}] (v3) at (1,0) {};
\node[vertexpt,label={[blue,very thick]above:2}] (v4) at (1,1) {};
\node[vertexpt,label={[red,very thick]below:3}] (v5) at (2,-0.5) {};
\node[vertexpt,label={[red,very thick]above:5}] (v6) at (2,0.5) {};
\node[vertexpt,label={[red,very thick]right:$\infty$}] (v7) at (3,0) {};

\path[arrow] (v1) to (v2);
\path[arrow] (v1) to (v3);
\path[arrow] (v1) to (v4);
\path[arrow] (v2) to (v3);
\path[arrow] (v3) to (v4);
\path[arrow] (v2) to (v5);
\path[arrow] (v4) to (v6);
\path[arrow] (v5) to (v6);
\path[arrow] (v5) to (v7);
\path[arrow] (v6) to (v7);
\node[blue,very thick] at (1.5,-2) {$S^{(3)}$};
\end{tikzpicture}\hspace{1cm}
\begin{tikzpicture}
\node[vertexpt,label={[blue,very thick]left:0}] (v1) at (0,0) {};
\node[vertexpt,label={[blue,very thick]below:2}] (v2) at (1,-1) {};
\node[vertexpt,label={[blue,very thick]right:1}] (v3) at (1,0) {};
\node[vertexpt,label={[blue,very thick]above:2}] (v4) at (1,1) {};
\node[vertexpt,label={[blue,very thick]below:3}] (v5) at (2,-0.5) {};
\node[vertexpt,label={[red,very thick]above:4}] (v6) at (2,0.5) {};
\node[vertexpt,label={[red,very thick]right:9}] (v7) at (3,0) {};

\path[arrow] (v1) to (v2);
\path[arrow] (v1) to (v3);
\path[arrow] (v1) to (v4);
\path[arrow] (v2) to (v3);
\path[arrow] (v3) to (v4);
\path[arrow] (v2) to (v5);
\path[arrow] (v4) to (v6);
\path[arrow] (v5) to (v6);
\path[arrow] (v5) to (v7);
\path[arrow] (v6) to (v7);
\node[blue,very thick] at (1.5,-2) {$S^{(4)}$};
\end{tikzpicture}\hspace{1cm}
\begin{tikzpicture}
\node[vertexpt,label={[blue,very thick]left:0}] (v1) at (0,0) {};
\node[vertexpt,label={[blue,very thick]below:2}] (v2) at (1,-1) {};
\node[vertexpt,label={[blue,very thick]right:1}] (v3) at (1,0) {};
\node[vertexpt,label={[blue,very thick]above:2}] (v4) at (1,1) {};
\node[vertexpt,label={[blue,very thick]below:3}] (v5) at (2,-0.5) {};
\node[vertexpt,label={[blue,very thick]above:4}] (v6) at (2,0.5) {};
\node[vertexpt,label={[red,very thick]right:6}] (v7) at (3,0) {};

\path[arrow] (v1) to (v2);
\path[arrow] (v1) to (v3);
\path[arrow] (v1) to (v4);
\path[arrow] (v2) to (v3);
\path[arrow] (v3) to (v4);
\path[arrow] (v2) to (v5);
\path[arrow] (v4) to (v6);
\path[arrow] (v5) to (v6);
\path[arrow] (v5) to (v7);
\path[arrow] (v6) to (v7);
\node[blue,very thick] at (1.5,-2) {$S^{(5)}$};
\end{tikzpicture}\\
\begin{tikzpicture}
\node[vertexpt,label={[blue,very thick]left:0}] (v1) at (0,0) {};
\node[vertexpt,label={[blue,very thick]below:2}] (v2) at (1,-1) {};
\node[vertexpt,label={[blue,very thick]right:1}] (v3) at (1,0) {};
\node[vertexpt,label={[blue,very thick]above:2}] (v4) at (1,1) {};
\node[vertexpt,label={[blue,very thick]below:3}] (v5) at (2,-0.5) {};
\node[vertexpt,label={[blue,very thick]above:4}] (v6) at (2,0.5) {};
\node[vertexpt,label={[blue,very thick]right:6}] (v7) at (3,0) {};

\path[arrow,blue,very thick] (v1) to (v2);
\path[arrow] (v1) to (v3);
\path[arrow] (v1) to (v4);
\path[arrow] (v2) to (v3);
\path[arrow] (v3) to (v4);
\path[arrow,blue,very thick] (v2) to (v5);
\path[arrow] (v4) to (v6);
\path[arrow,blue,very thick] (v5) to (v6);
\path[arrow] (v5) to (v7);
\path[arrow,blue,very thick] (v6) to (v7);
\node[blue,very thick] at (1.5,-2) {$S^{(6)}$};
\end{tikzpicture}\\
\emph{$\Rightarrow$ Kürzeste $s-v$-Wege für jedes $v$}
\end{center}
\subsubsection{Prozedur: Dijkstra-Algorithmus\index{Algorithmus!Dijkstra}}\ssslbl
\begin{lstlisting}
INPUT Bewerteter allgemeiner Graph $G=(V,E,\nu,\Phi)$ mit $\Phi\geq0$, $s\in V$
OUTPUT Länge $\xi(v9$ kürzester $s-v$-Wege für alle von $s$ aus erreichbaren Knoten
BEGIN $S\leftarrow\{s\}$, $\xi(s)\leftarrow0$
  FOR ALL $v\in N(G,S)$ DO
    $\xi(v)\leftarrow\min\bigl\{\Phi(e)\::\:e\in E\:,\:\nu(e)\in\{(s,v),\{s,v\}\bigr\}$
  WHILE $N(G,S)\neq\emptyset$ DO
    BEGIN
      wähle $v^*\in argmin\bigl\{\xi(v)\::\:v\in N(G,S)\bigr\}$
      FOR ALL $v\in N(G,v^*)\setminus\bigl(S\cup N(G,S)\bigr)$ DO
        $\xi(v)\leftarrow\xi(v^*)+\min\bigl\{\Phi(e)\::\:e\in E\:\wedge\:\nu(e)\in\{\{v^*,s\},(v^*,s)\}\bigr\}$
      FOR ALL $v\in N(G,S)\setminus\{v^*\}$ DO
        $\xi(v)\leftarrow\min\Bigl\{\xi(v),\:\xi(v^*)+\min\bigl\{\Phi(e)\::\:e\in E\:\wedge\:\nu(e)\in\{\{v^*,v\},(v^*,v)\}\bigr\}\Bigr\}$
      $S\leftarrow S\cup\{v^*\}$
    END
  END
END
\end{lstlisting}
\subsubsection{Satz}\ssslbl
Der Dijkstra-Algorithmus findet für jeden gewichteten allgemeinen Graphen $G=(V,E,\nu,\Phi)$ mit $\Phi\geq0$ in $\mathcal O\bigl(\vert V\vert^2+\vert E\vert\bigr)$ elementaren Operationen die Längen kürzester $s-v$-Wege für alle $v\in V$. Sind Kantengewichte rational, so sind die binären Größen der auftretenden Zahlen durch die Größe des Inputs beschränkt.
\subsubsection*{Beweis}
binäre Größe: $\checkmark$, Anzahl elementarer Operationen: $\checkmark$ (in jedem Schritt wird $S$ um einen Knoten vergrößert)\\[1ex]
Korrektheit: Induktion nach Schrittzahl $k$, $S^{(k)}$ Knotenmenge nach Schritt $k$, $\xi^{(k)}(v)$ Label.\\[1ex]
Zeige: $v\in S^{(k)}$ $\Rightarrow$ $\xi^{(k)}(v)$ Länge kürzester $s-v$-Wege\\[2ex]
$k=0$: ($\Phi\geq0$) $\checkmark$\\[1ex]
Für $N(G,S^{(k)})=\emptyset$ fertig. Sei $v^*\in N(G,S^{(k)})$ minimales Label unter allen solchen. Sei $W$ $s-v^*$-Weg, wo der von $s$ aus erste Knoten auf $W$, der nicht zu $S^{(k)}$ gehört, $v_0$ sein Vorgänger. Wegen $\Phi\geq0$ gilt nach Induktionsvoraussetzung:
\begin{align*}
\varphi(W)&\geq\xi^{(k)}(v_0)+\min\Bigl\{\Phi(e)\::\:e\in E\:,\:\nu(e)\in\bigl\{\{v_o,w_0\},(v_0,w_0)\bigr\}\Bigr\}\\
&\geq\xi^{(k)}\\
&\geq\xi^{(k)}(v^*)
\end{align*}
\subsubsection{Beispiel}\ssslbl
\begin{center}
\begin{tikzpicture}
\node[vertexpt,label=left:$s$] (s1) at (0,0) {};
\node[vertexpt,label=right:$t$] (t1) at (2,0) {};
\node[vertexpt] (v1) at (2,-2) {};
\path[arrow] (s1) to (t1) node[midway,above] {2};
\path[arrow] (s1) to (v1) node[midway,below] {3};
\path[arrow] (v1) to (t1) node[midway,right] {-2};
\begin{scope}[xshift=4cm]
\node[vertexpt,label={[orange]left:0}] (s2) at (0,0) {};
\node[vertexpt,label={[orange]right:2}] (t2) at (2,0) {};
\node[vertexpt,label={[orange]right:3}] (v2) at (2,-2) {};
\path[arrow] (s2) to (t2);
\path[arrow] (s2) to (v2);
\path[arrow] (v2) to (t2);

\begin{scope}[xshift=4cm]
\node[vertexpt] (s3) at (0,0) {};
\node[vertexpt] (t3) at (2,0) {};
\node[vertexpt] (v3) at (2,-2) {};
\path[arrow] (s3) to (t3);
\path[arrow,red,very thick] (s3) to (v3) node[midway,below] {3};
\path[arrow,red,very thick] (v3) to (t3) node[midway,right] {-2};
\end{scope}
\end{scope}
\end{tikzpicture}\\
\emph{Voraussetzungen für Dijkstra nicht erfüllt: \textcolor{orange}{Dijkstra: 2}, \textcolor{red}{Optimum: 1}}
\end{center}
\printindex
\end{document}